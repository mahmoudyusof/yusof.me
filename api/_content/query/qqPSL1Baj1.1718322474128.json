{"_path":"/blog/scikit-learn-pipelines","_dir":"blog","_draft":false,"_partial":false,"_locale":"","title":"A Comprehensive Guide For scikit-learn Pipelines","description":"Going through a step by step guide for building machine learning pipelines for data preprocessing and inference, also covering how preprocess different columns with different transformers, how to add custom transformers, and how to save and load complete pipelines","type":"article","date":"2021-01-26","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"a-comprehensive-guide-for-scikit-learn-pipelines"},"children":[{"type":"text","value":"A Comprehensive Guide For scikit-learn Pipelines"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Scikit Learn has a very easy and useful architecture for building complete pipelines for machine learning. In this article, we'll go through a step by step example on how to used the different features and classes of this architecture."}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h2","props":{"id":"why"},"children":[{"type":"text","value":"Why?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"There are plenty of reasons why you might want to use a pipeline for machine learning like:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Combine the preprocessing step with the inference step at one object."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Save the complete pipeline to disk."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Easily experiment with different techniques of preprocessing."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Pipeline reuse."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Easy cloud deployment."}]}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h2","props":{"id":"how"},"children":[{"type":"text","value":"How?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Alright, now let's get down to business. In this article we'll use a fairly easy and old problem as an example, which is the "},{"type":"element","tag":"a","props":{"className":["mdlink"],"href":"https://www.kaggle.com/c/home-data-for-ml-course"},"children":[{"type":"text","value":"Regression problem for predicting housing prices"}]},{"type":"text","value":"."},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nDownload the data and you should have a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"train.csv"}]},{"type":"text","value":" file and a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"test.csv"}]},{"type":"text","value":" file, we'll load both using pandas."}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h3","props":{"id":"loading-the-data"},"children":[{"type":"text","value":"Loading the data"}]},{"type":"element","tag":"pre","props":{"className":"language-python shiki shiki-themes dark-plus github-dark","code":"import pandas as pd\nimport numpy as np\n\ntrain_df = pd.read_csv(\"train.csv\")\ntest_df = pd.read_csv(\"test.csv\")\n\n## let's create a validation set from the training set\n\nmsk = np.random.rand(len(train_df)) < 0.8\n\nval_df = train_df[~msk]\n\ntrain_df = train_df[msk]\n\n","language":"python","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" pandas "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" pd\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" numpy "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" np\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"train_df "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" pd.read_csv("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"train.csv\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"test_df "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" pd.read_csv("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"test.csv\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"## let's create a validation set from the training set\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"msk "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" np.random.rand("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(train_df)) "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" 0.8\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"val_df "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" train_df["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"~"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"msk]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"train_df "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" train_df[msk]\n"}]}]}]}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h3","props":{"id":"feature-selection"},"children":[{"type":"text","value":"Feature selection"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This data has 163 columns, however, we are not going to use all of them."},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nAfter doing a bit of EDA we choose a set of nominal, ordinal and numerical columns to work with."}]},{"type":"element","tag":"pre","props":{"className":"language-python shiki shiki-themes dark-plus github-dark","code":"\nnominal = [\"MSZoning\", \"LotShape\", \"LandContour\", \"LotConfig\", \"Neighborhood\",\n           \"Condition1\", \"BldgType\", \"RoofStyle\",\n           \"Foundation\", \"CentralAir\", \"SaleType\", \"SaleCondition\"]\n\nordinal = [\"LandSlope\", \"OverallQual\", \"OverallCond\", \"YearRemodAdd\",\n          \"ExterQual\", \"ExterCond\", \"BsmtQual\", \"BsmtCond\", \"BsmtExposure\",\n          \"KitchenQual\", \"Functional\", \"GarageCond\", \"PavedDrive\"]\n\nnumerical = [\"LotFrontage\", \"LotArea\", \"MasVnrArea\", \"BsmtFinSF1\", \"BsmtUnfSF\",\n            \"TotalBsmtSF\", \"1stFlrSF\", \"2ndFlrSF\", \"GrLivArea\", \"GarageArea\",\n            \"OpenPorchSF\"]\n\ntrain_features = train_df[nominal + ordinal + numerical]\ntrain_label = train_df[\"SalePrice\"]\n\nval_features = val_df[nominal + ordinal + numerical]\nval_label = val_df[\"SalePrice\"]\n\ntest_features = test_df[nominal + ordinal + numerical]\n\n","language":"python","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"nominal "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" ["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"MSZoning\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"LotShape\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"LandContour\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"LotConfig\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"Neighborhood\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"           \"Condition1\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"BldgType\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"RoofStyle\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"           \"Foundation\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"CentralAir\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"SaleType\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"SaleCondition\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"ordinal "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" ["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"LandSlope\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"OverallQual\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"OverallCond\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"YearRemodAdd\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"          \"ExterQual\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"ExterCond\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"BsmtQual\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"BsmtCond\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"BsmtExposure\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"          \"KitchenQual\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"Functional\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"GarageCond\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"PavedDrive\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"numerical "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" ["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"LotFrontage\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"LotArea\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"MasVnrArea\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"BsmtFinSF1\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"BsmtUnfSF\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"            \"TotalBsmtSF\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"1stFlrSF\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"2ndFlrSF\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"GrLivArea\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"GarageArea\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"            \"OpenPorchSF\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"train_features "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" train_df[nominal "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" ordinal "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" numerical]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"train_label "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" train_df["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"SalePrice\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"val_features "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" val_df[nominal "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" ordinal "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" numerical]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"val_label "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" val_df["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"SalePrice\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"test_features "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" test_df[nominal "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" ordinal "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" numerical]\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you want to see the entire selection process and EDA fully explained, you can see the notebook "},{"type":"element","tag":"a","props":{"className":["mdlink"],"href":"https://www.kaggle.com/mahmoud1youssef/housing-prices-full-solution"},"children":[{"type":"text","value":"here"}]}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h3","props":{"id":"preprocessing"},"children":[{"type":"text","value":"Preprocessing"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now let's choose a preprocessing plan, a very straight forward one is the following:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Ordinal features\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Impute missing data with most frequent value"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Use Ordinal Encoding"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Nominal Features\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Impute missing data with most frequent value"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Use One Hot Encoding"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Numerical Features\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Impute missing data with mean value"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Use Standard Scaling"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"As you may see, each family of features has its own unique way of getting processed. Let's create a Pipeline for each family."},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nWe can do so by using the "},{"type":"element","tag":"a","props":{"className":["mdlink"],"href":"https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html"},"children":[{"type":"text","value":"sklearn.pipeline.Pipeline"}]},{"type":"text","value":" Object"}]},{"type":"element","tag":"pre","props":{"className":"language-python shiki shiki-themes dark-plus github-dark","code":"from sklearn.pipeline import Pipeline\nfrom sklearn.impute import SimpleImputer\nfrom sklearn.preprocessing import StandardScaler, OrdinalEncoder, OneHotEncoder\n\nordinal_pipeline = Pipeline([\n    (\"imputer\", SimpleImputer(strategy=\"most_frequent\")),\n    (\"encoder\", OrdinalEncoder())\n])\n\nnominal_pipeline = Pipeline([\n    (\"imputer\", SimpleImputer(strategy=\"most_frequent\")),\n    (\"encoder\", OneHotEncoder(sparse=True, handle_unknown=\"ignore\"))\n])\n\nnumerical_pipeline = Pipeline([\n    (\"imputer\", SimpleImputer(strategy=\"mean\")),\n    (\"scaler\", StandardScaler())\n])\n","language":"python","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" sklearn.pipeline "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" Pipeline\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" sklearn.impute "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" SimpleImputer\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" sklearn.preprocessing "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" StandardScaler, OrdinalEncoder, OneHotEncoder\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"ordinal_pipeline "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" Pipeline([\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"imputer\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", SimpleImputer("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"strategy"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"most_frequent\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"encoder\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", OrdinalEncoder())\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"])\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"nominal_pipeline "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" Pipeline([\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"imputer\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", SimpleImputer("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"strategy"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"most_frequent\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"encoder\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", OneHotEncoder("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"sparse"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"True"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"handle_unknown"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"ignore\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"])\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"numerical_pipeline "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" Pipeline([\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"imputer\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", SimpleImputer("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"strategy"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"mean\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"scaler\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", StandardScaler())\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"])\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now let's join all of the above in one pipeline that targets each column with its family's pipeline."},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nWe can do so using the "},{"type":"element","tag":"a","props":{"className":["mdlink"],"href":"https://scikit-learn.org/stable/modules/generated/sklearn.compose.ColumnTransformer.html?highlight=columntransformer#sklearn.compose.ColumnTransformer"},"children":[{"type":"text","value":"sklearn.compose.ColumnTransformer"}]},{"type":"text","value":" Object"}]},{"type":"element","tag":"pre","props":{"className":"language-python shiki shiki-themes dark-plus github-dark","code":"from sklearn.compose import ColumnTransformer\n\n# here we are going to instantiate a ColumnTransformer object with a list of tuples\n# each of which has a the name of the preprocessor\n# the transformation pipeline (could be a transformer)\n# and the list of column names we wish to transform\n\npreprocessing_pipeline = ColumnTransformer([\n    (\"nominal_preprocessor\", nominal_pipeline, nominal),\n    (\"ordinal_preprocessor\", ordinal_pipeline, ordinal),\n    (\"numerical_preprocessor\", numerical_pipeline, numerical)\n])\n\n## If you want to test this pipeline run the following code\n\n# preprocessed_features = preprocessing_pipeline.fit_transform(train_features)\n\n","language":"python","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" sklearn.compose "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" ColumnTransformer\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# here we are going to instantiate a ColumnTransformer object with a list of tuples\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# each of which has a the name of the preprocessor\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# the transformation pipeline (could be a transformer)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# and the list of column names we wish to transform\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"preprocessing_pipeline "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" ColumnTransformer([\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"nominal_preprocessor\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", nominal_pipeline, nominal),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"ordinal_preprocessor\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", ordinal_pipeline, ordinal),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"numerical_preprocessor\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", numerical_pipeline, numerical)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"])\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"## If you want to test this pipeline run the following code\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# preprocessed_features = preprocessing_pipeline.fit_transform(train_features)\n"}]}]}]}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h3","props":{"id":"adding-the-model-to-the-pipeline"},"children":[{"type":"text","value":"Adding the model to the pipeline"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now that we're done creating the preprocessing pipeline let's add the model to the end."}]},{"type":"element","tag":"pre","props":{"className":"language-python shiki shiki-themes dark-plus github-dark","code":"from sklearn.linear_model import LinearRegression\n\ncomplete_pipeline = Pipeline([\n    (\"preprocessor\", preprocessing_pipeline),\n    (\"estimator\", LinearRegression())\n])\n\n","language":"python","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" sklearn.linear_model "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" LinearRegression\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"complete_pipeline "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" Pipeline([\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"preprocessor\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", preprocessing_pipeline),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"estimator\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", LinearRegression())\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"])\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you're waiting for the rest of the code, I'd like to tell you that that's it. Pretty easy isn't it. If the scikit-learn maintainers ask to take my heart I'd give it to them for such great API."},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nThe training and evaluation process is the same as any normal model"}]},{"type":"element","tag":"pre","props":{"className":"language-python shiki shiki-themes dark-plus github-dark","code":"complete_pipeline.fit(train_features, train_label)\nscore = complete_pipeline.score(val_features, val_label)\n\nprint(score)\n\npredictions = complete_pipeline.predict(test_features)\n","language":"python","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"complete_pipeline.fit(train_features, train_label)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"score "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" complete_pipeline.score(val_features, val_label)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"print"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(score)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"predictions "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" complete_pipeline.predict(test_features)\n"}]}]}]}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h2","props":{"id":"saving-and-loading-pipelines"},"children":[{"type":"text","value":"Saving and Loading Pipelines"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now we want to save the entire preprocessing parameters and model parameters of this pipeline to disk and load it whenever needed."},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nWe are going to use "},{"type":"element","tag":"a","props":{"href":"https://joblib.readthedocs.io/en/latest/","className":["mdlink"]},"children":[{"type":"text","value":"joblib"}]},{"type":"text","value":" for this "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"JOB"}]},{"type":"text","value":" ... get it? ... sorry."}]},{"type":"element","tag":"h3","props":{"id":"save-the-pipeline"},"children":[{"type":"text","value":"Save the pipeline"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We are going to save the model as a pickle (.pkl) file. The code is fairly simple."}]},{"type":"element","tag":"pre","props":{"className":"language-python shiki shiki-themes dark-plus github-dark","code":"import joblib\n\npipeline_filename = \"my_pipeline.pkl\"\njoblib.dump(complete_pipeline, pipeline_filename)\n\n","language":"python","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" joblib\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"pipeline_filename "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":" \"my_pipeline.pkl\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"joblib.dump(complete_pipeline, pipeline_filename)\n"}]}]}]}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h3","props":{"id":"load-the-pipeline"},"children":[{"type":"text","value":"Load the pipeline"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now you're on your flask server and you wish to load the model to help a user predict the price of a house, so you want to load the model from disk when you start the server, or whenever a request is sent. That is also fairly simple."}]},{"type":"element","tag":"pre","props":{"className":"language-python shiki shiki-themes dark-plus github-dark","code":"import joblib\n\npipeline_filename = \"path/to/pipeline/file.pkl\"\n\npipeline = joblib.load(pipeline_filename)\n\n## do inference with pipeline.predict\n# ...\n","language":"python","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" joblib\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"pipeline_filename "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":" \"path/to/pipeline/file.pkl\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"pipeline "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" joblib.load(pipeline_filename)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"## do inference with pipeline.predict\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# ...\n"}]}]}]}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"h2","props":{"id":"full-code"},"children":[{"type":"text","value":"Full Code"}]},{"type":"element","tag":"pre","props":{"className":"language-python shiki shiki-themes dark-plus github-dark","code":"\nimport pandas as pd\nimport numpy as np\n\ntrain_df = pd.read_csv(\"train.csv\")\ntest_df = pd.read_csv(\"test.csv\")\n\n## let's create a validation set from the training set\n\nmsk = np.random.rand(len(train_df)) < 0.8\n\nval_df = train_df[~msk]\n\ntrain_df = train_df[msk]\n\n\nnominal = [\"MSZoning\", \"LotShape\", \"LandContour\", \"LotConfig\", \"Neighborhood\",\n           \"Condition1\", \"BldgType\", \"RoofStyle\",\n           \"Foundation\", \"CentralAir\", \"SaleType\", \"SaleCondition\"]\n\nordinal = [\"LandSlope\", \"OverallQual\", \"OverallCond\", \"YearRemodAdd\",\n          \"ExterQual\", \"ExterCond\", \"BsmtQual\", \"BsmtCond\", \"BsmtExposure\",\n          \"KitchenQual\", \"Functional\", \"GarageCond\", \"PavedDrive\"]\n\nnumerical = [\"LotFrontage\", \"LotArea\", \"MasVnrArea\", \"BsmtFinSF1\", \"BsmtUnfSF\",\n            \"TotalBsmtSF\", \"1stFlrSF\", \"2ndFlrSF\", \"GrLivArea\", \"GarageArea\",\n            \"OpenPorchSF\"]\n\ntrain_features = train_df[nominal + ordinal + numerical]\ntrain_label = train_df[\"SalePrice\"]\n\nval_features = val_df[nominal + ordinal + numerical]\nval_label = val_df[\"SalePrice\"]\n\ntest_features = test_df[nominal + ordinal + numerical]\n\n\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.impute import SimpleImputer\nfrom sklearn.preprocessing import StandardScaler, OrdinalEncoder, OneHotEncoder\n\nordinal_pipeline = Pipeline([\n    (\"imputer\", SimpleImputer(strategy=\"most_frequent\")),\n    (\"encoder\", OrdinalEncoder())\n])\n\nnominal_pipeline = Pipeline([\n    (\"imputer\", SimpleImputer(strategy=\"most_frequent\")),\n    (\"encoder\", OneHotEncoder(sparse=True, handle_unknown=\"ignore\"))\n])\n\nnumerical_pipeline = Pipeline([\n    (\"imputer\", SimpleImputer(strategy=\"mean\")),\n    (\"scaler\", StandardScaler())\n])\n\n\nfrom sklearn.compose import ColumnTransformer\n\n# here we are going to instantiate a ColumnTransformer object with a list of tuples\n# each of which has a the name of the preprocessor\n# the transformation pipeline (could be a transformer)\n# and the list of column names we wish to transform\n\npreprocessing_pipeline = ColumnTransformer([\n    (\"nominal_preprocessor\", nominal_pipeline, nominal),\n    (\"ordinal_preprocessor\", ordinal_pipeline, ordinal),\n    (\"numerical_preprocessor\", numerical_pipeline, numerical)\n])\n\n## If you want to test this pipeline run the following code\n\n# preprocessed_features = preprocessing_pipeline.fit_transform(train_features)\n\n\nfrom sklearn.linear_model import LinearRegression\n\ncomplete_pipeline = Pipeline([\n    (\"preprocessor\", preprocessing_pipeline),\n    (\"estimator\", LinearRegression())\n])\n\n\ncomplete_pipeline.fit(train_features, train_label)\nscore = complete_pipeline.score(val_features, val_label)\n\nprint(score)\n\npredictions = complete_pipeline.predict(test_features)\n\n\nimport joblib\n\npipeline_filename = \"my_pipeline.pkl\"\njoblib.dump(complete_pipeline, pipeline_filename)\n\n\npipeline = joblib.load(pipeline_filename)\n\npredictions = pipeline.predict(test_df)\nprint(predictions)\n\n","language":"python","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" pandas "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" pd\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" numpy "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" np\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"train_df "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" pd.read_csv("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"train.csv\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"test_df "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" pd.read_csv("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"test.csv\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"## let's create a validation set from the training set\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"msk "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" np.random.rand("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(train_df)) "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" 0.8\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"val_df "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" train_df["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"~"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"msk]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"train_df "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" train_df[msk]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"nominal "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" ["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"MSZoning\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"LotShape\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"LandContour\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"LotConfig\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"Neighborhood\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"           \"Condition1\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"BldgType\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"RoofStyle\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"           \"Foundation\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"CentralAir\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"SaleType\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"SaleCondition\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"ordinal "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" ["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"LandSlope\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"OverallQual\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"OverallCond\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"YearRemodAdd\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"          \"ExterQual\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"ExterCond\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"BsmtQual\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"BsmtCond\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"BsmtExposure\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"          \"KitchenQual\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"Functional\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"GarageCond\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"PavedDrive\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"numerical "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" ["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"LotFrontage\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"LotArea\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"MasVnrArea\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"BsmtFinSF1\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"BsmtUnfSF\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"            \"TotalBsmtSF\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"1stFlrSF\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"2ndFlrSF\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"GrLivArea\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"GarageArea\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"            \"OpenPorchSF\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"train_features "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" train_df[nominal "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" ordinal "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" numerical]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"train_label "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" train_df["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"SalePrice\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":32},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"val_features "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" val_df[nominal "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" ordinal "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" numerical]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":33},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"val_label "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" val_df["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"SalePrice\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":34},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":35},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"test_features "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" test_df[nominal "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" ordinal "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"+"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" numerical]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":36},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":37},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":38},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" sklearn.pipeline "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" Pipeline\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":39},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" sklearn.impute "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" SimpleImputer\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":40},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" sklearn.preprocessing "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" StandardScaler, OrdinalEncoder, OneHotEncoder\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":41},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":42},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"ordinal_pipeline "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" Pipeline([\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":43},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"imputer\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", SimpleImputer("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"strategy"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"most_frequent\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":44},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"encoder\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", OrdinalEncoder())\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":45},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"])\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":46},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":47},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"nominal_pipeline "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" Pipeline([\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":48},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"imputer\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", SimpleImputer("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"strategy"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"most_frequent\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":49},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"encoder\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", OneHotEncoder("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"sparse"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"True"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"handle_unknown"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"ignore\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":50},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"])\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":51},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":52},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"numerical_pipeline "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" Pipeline([\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":53},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"imputer\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", SimpleImputer("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"strategy"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"mean\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":54},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"scaler\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", StandardScaler())\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":55},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"])\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":56},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":57},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":58},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" sklearn.compose "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" ColumnTransformer\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":59},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":60},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# here we are going to instantiate a ColumnTransformer object with a list of tuples\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":61},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# each of which has a the name of the preprocessor\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":62},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# the transformation pipeline (could be a transformer)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":63},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# and the list of column names we wish to transform\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":64},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":65},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"preprocessing_pipeline "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" ColumnTransformer([\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":66},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"nominal_preprocessor\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", nominal_pipeline, nominal),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":67},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"ordinal_preprocessor\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", ordinal_pipeline, ordinal),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":68},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"numerical_preprocessor\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", numerical_pipeline, numerical)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":69},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"])\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":70},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":71},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"## If you want to test this pipeline run the following code\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":72},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":73},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"# preprocessed_features = preprocessing_pipeline.fit_transform(train_features)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":74},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":75},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":76},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" sklearn.linear_model "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" LinearRegression\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":77},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":78},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"complete_pipeline "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" Pipeline([\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":79},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"preprocessor\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", preprocessing_pipeline),\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":80},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"estimator\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", LinearRegression())\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":81},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"])\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":82},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":83},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":84},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"complete_pipeline.fit(train_features, train_label)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":85},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"score "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" complete_pipeline.score(val_features, val_label)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":86},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":87},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"print"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(score)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":88},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":89},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"predictions "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" complete_pipeline.predict(test_features)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":90},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":91},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":92},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" joblib\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":93},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":94},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"pipeline_filename "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":" \"my_pipeline.pkl\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":95},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"joblib.dump(complete_pipeline, pipeline_filename)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":96},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":97},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":98},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"pipeline "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" joblib.load(pipeline_filename)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":99},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":100},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"predictions "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" pipeline.predict(test_df)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":101},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"print"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(predictions)\n"}]}]}]}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"That's it, Congratulations, you've just created, saved and loaded your complete pipeline."},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nI hope this article was helpful, if not, please tell me how to improve it, I would really appreciate that.\nThank you."}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"className":["mdlink"],"href":"https://www.oreilly.com/library/view/hands-on-machine-learning/9781492032632/"},"children":[{"type":"text","value":"Reference Book"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"className":["mdlink"],"href":"https://www.kaggle.com/mahmoud1youssef/housing-prices-full-solution"},"children":[{"type":"text","value":"My Notebook"}]}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"why","depth":2,"text":"Why?"},{"id":"how","depth":2,"text":"How?","children":[{"id":"loading-the-data","depth":3,"text":"Loading the data"},{"id":"feature-selection","depth":3,"text":"Feature selection"},{"id":"preprocessing","depth":3,"text":"Preprocessing"},{"id":"adding-the-model-to-the-pipeline","depth":3,"text":"Adding the model to the pipeline"}]},{"id":"saving-and-loading-pipelines","depth":2,"text":"Saving and Loading Pipelines","children":[{"id":"save-the-pipeline","depth":3,"text":"Save the pipeline"},{"id":"load-the-pipeline","depth":3,"text":"Load the pipeline"}]},{"id":"full-code","depth":2,"text":"Full Code"}]}},"_type":"markdown","_id":"content:blog:3.scikit-learn-pipelines.md","_source":"content","_file":"blog/3.scikit-learn-pipelines.md","_extension":"md"}
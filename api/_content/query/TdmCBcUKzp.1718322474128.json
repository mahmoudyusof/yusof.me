{"_path":"/blog/client-side-inference","_dir":"blog","_draft":false,"_partial":false,"_locale":"","title":"Client Side Inference with TFJS","description":"How to convert models to JavaScript compatible format, save them on the clients' browsers and load them for inference.","type":"article","date":"2021-02-24","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"client-side-inference-with-tfjs"},"children":[{"type":"text","value":"Client Side Inference with TFJS"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This article explains everything you need to know in order to start using deeplearning models in the browser."},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nIn particular, we are going to talk about running inference in the browswer, since training models in the browser doesn't really make that much sense. God bless Google Colab <3"}]},{"type":"element","tag":"h2","props":{"id":"why"},"children":[{"type":"text","value":"Why?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Traditionally, we used to load a model in server (usually flask servers), send requests with the input features to that server, run inference and send the results in the response. That's fine, but if you have a big web app that handles a lot of different requests, then it makes perfect sense to outsource some of the computations to the front-end, which would improve the performance of your web app."},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nThe most time consuming task you might have in your webserver might be the inference task, if you outsource this task to the browser, your server is going to be blazing fast."}]},{"type":"element","tag":"h2","props":{"id":"how"},"children":[{"type":"text","value":"How?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Sold, now tell me how to do it."},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nWe all know that the most used language on the browser is JavaScript. If you don't like it, then maybe this article is not for you."},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nLet's see the steps that we need to go through to get what we want."}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Install tensorflowjs-converter."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Convert a saved model to js compatible format."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Send the model in a response and save it in the browser."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Load the model from the browser and run inference."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The model I am going to use in here is a generator model, you can find how to create it and save it in "},{"type":"element","tag":"a","props":{"href":"https://github.com/mahmoudyusof/hands-on-ml/blob/master/17_Generative_Models/DCGANs.ipynb","rel":["nofollow"]},"children":[{"type":"text","value":"this notebook"}]}]},{"type":"element","tag":"h3","props":{"id":"installing-tensorflowjs-converter"},"children":[{"type":"text","value":"Installing tensorflowjs-converter"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This CLI tool comes by default when you install tensorflowjs via pip."}]},{"type":"element","tag":"pre","props":{"code":"$ pip install tensorflowjs\n","language":"shell","meta":"","className":"language-shell shiki shiki-themes dark-plus github-dark","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"$"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":" pip"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":" install"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":" tensorflowjs\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"That's it, now you have the converter installed and you can use the CLI to convert your model to the required format for TFJS."}]},{"type":"element","tag":"h3","props":{"id":"converting-the-saved-model"},"children":[{"type":"text","value":"Converting the saved model"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Before we start with the conversion, you should take a look at the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"--help"}]},{"type":"text","value":" option in this command."}]},{"type":"element","tag":"pre","props":{"code":"$ tensorflowjs_converter --help\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"$ tensorflowjs_converter --help\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"As you can see, there are multiple input formats available, since there are many ways by which you can save a model."},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nIn my case I used keras to create the model and saved it in a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"SavedModel"}]},{"type":"text","value":" format which creates a directory with a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"saved_model.pb"}]},{"type":"text","value":" file in it."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now we want to convert this model."}]},{"type":"element","tag":"pre","props":{"code":"$ tensorflow_converter --input_format=tf_saved_model source/model/directory target/save/directory\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"$ tensorflow_converter --input_format=tf_saved_model source/model/directory target/save/directory\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In this command "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"source/model/directory"}]},{"type":"text","value":" should have a file with the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"pb"}]},{"type":"text","value":" extension. This will output a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"model.json"}]},{"type":"text","value":" file and some other binary fiels in the target directory."}]},{"type":"element","tag":"h3","props":{"id":"save-the-model-in-the-browser"},"children":[{"type":"text","value":"Save the model in the browser"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now for some JS stuff. First install tensorflowjs in your app. You can use npm or just include the CDN link in your code directly."}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"CDN "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"<script src=\"https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0/dist/tf.min.js\"></script> "}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"npm installation "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"$ npm install --save @tensorflow/tfjs"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"yarn installation "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"$ yarn add @tensorflow/tfjs"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now let's create a funciton that responds to, for example, a click event. This function will do the following:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Try to load the model from localStorage\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"If it fails it will load the model from the server"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Then save the model in localStorage"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Run inference with the model"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Update UI to display results"}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In the following code we will be using a GAN model to generate hand written digits. If you don't know how GANs work, basically we need a random vector and we'll pass it to the model and the model will return a 28 by 28 image. In this particular GAN we also give it a label specifying which digit we want to generate."}]}]},{"type":"element","tag":"pre","props":{"code":"// load the model from localstorage\ntf.fromGraphModel(\"localstorage://saved_model_name\")\n    .then(model => {\n        // success case, run the generate function.\n        generate(model);\n    }).catch(e => {\n        // if you fail, load the model from the server\n        tf.fromGraphModel(\"http://model-server-url/model_directory\")\n            .then(model => {\n            // In the chained \"then call\" save the model in localstorage\n            model.save(\"localstorage://saved_model_name\");\n            \n            // run inference\n            generate(model);\n        }).catch(e => {\n            console.log(\"some unexpected error\");\n            console.log(e);\n        });\n    });\n","language":"js","meta":"","className":"language-js shiki shiki-themes dark-plus github-dark","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"// load the model from localstorage\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"fromGraphModel"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"localstorage://saved_model_name\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"then"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"model"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"        // success case, run the generate function.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"        generate"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"model"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    })."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"catch"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"e"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"        // if you fail, load the model from the server\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"        tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"fromGraphModel"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"http://model-server-url/model_directory\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            ."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"then"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"model"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // In the chained \"then call\" save the model in localstorage\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            model"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"save"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"localstorage://saved_model_name\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // run inference\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"            generate"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"model"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"        })."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"catch"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"e"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            console"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"some unexpected error\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            console"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"e"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"        });\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    });\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now let's take a look at the generate method and see what it does. This is where most of the tfjs stuff takes place."}]},{"type":"element","tag":"pre","props":{"code":"// import the library under the tf namespace\nimport * as tf from \"@tensorflow/tfjs\";\n\nfunction generate(model){\n    // tf.tidy handles garbage collection to prevent any memory leakage\n    tf.tidy(() => {\n        // vector of shape [batch_size, encoding_dim]\n        const random_vector = tf.randomNormal([1, 100]);\n\n        // the label tensor, shape is [batch_size, 1]\n        // I am passing the data type as int32 because I want the funciton to return an int,\n        // however the model accepts float numbers not ints this is why I am casting the tensor.\n        const label = tf.randomUniform([1, 1], 0, 10, \"int32\").cast(\"float32\");\n\n        // generate new image\n        model.execute([random_vector, label]).then(image => {\n            // let's dispose of the model since we don't need it in memory any more\n            model.dispose();\n            // images are of shape [batch_size, 28, 28]\n            // batch_size here is 1 so we can remove it by squeezing the tensor\n            image = image.squeeze();\n\n            // the output of the model ranges from -1 to 1,\n            // let's make it from 0 to 1 since the next funciton is picky\n            image = tf.div(tf.add(image, tf.scalar(1)), tf.scalar(2))\n\n            // let's now make the image of rank 3 to make it an appropriate image\n            // of shape [28, 28, 1] which means a gray scale image\n            // The second argument of this function is the axis of expansion\n            image = tf.expandDims(image, 2);\n\n            // Let's now resize the image from [28, 28, 1] to [200, 200, 1].\n            image = tf.image.resizeNearestNeighbor(img, [200, 200]);\n\n            // Now let's get the canvas element, that we should create in markup, and write this image to it.\n            const canvas = document.getElementById(\"myCanvas\");\n            \n            tf.browser.toPixels(image, canvas)\n            .then(output => {\n                console.log(\"Success\");\n            }).catch(e => {\n                console.log(e);\n            })\n\n            /**\n             * Horrai!! you did it,\n             * you just created a function that runs a GAN on the browser!\n            */\n        }).catch(e => {\n            model.dispose();\n        });\n    });\n}\n\n","language":"js","meta":"","className":"language-js shiki shiki-themes dark-plus github-dark","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"// import the library under the tf namespace\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" *"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":" as"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":" from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":" \"@tensorflow/tfjs\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":"function"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" generate"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"model"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"){\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"    // tf.tidy handles garbage collection to prevent any memory leakage\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"tidy"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(() "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"        // vector of shape [batch_size, encoding_dim]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":"        const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4FC1FF;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" random_vector"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"randomNormal"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"100"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"]);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"        // the label tensor, shape is [batch_size, 1]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"        // I am passing the data type as int32 because I want the funciton to return an int,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"        // however the model accepts float numbers not ints this is why I am casting the tensor.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":"        const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4FC1FF;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" label"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"randomUniform"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"], "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"10"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"int32\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"cast"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"float32\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"        // generate new image\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"        model"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"execute"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"random_vector"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"label"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"])."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"then"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"image"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // let's dispose of the model since we don't need it in memory any more\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            model"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"dispose"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // images are of shape [batch_size, 28, 28]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // batch_size here is 1 so we can remove it by squeezing the tensor\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            image"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" image"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"squeeze"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // the output of the model ranges from -1 to 1,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // let's make it from 0 to 1 since the next funciton is picky\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            image"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"add"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"image"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"scalar"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")), "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"scalar"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // let's now make the image of rank 3 to make it an appropriate image\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // of shape [28, 28, 1] which means a gray scale image\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // The second argument of this function is the axis of expansion\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            image"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"expandDims"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"image"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":32},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // Let's now resize the image from [28, 28, 1] to [200, 200, 1].\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":33},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            image"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"image"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"resizeNearestNeighbor"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"img"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", ["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"200"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"200"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"]);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":34},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":35},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // Now let's get the canvas element, that we should create in markup, and write this image to it.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":36},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":"            const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4FC1FF;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" canvas"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" document"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"getElementById"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"myCanvas\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":37},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":38},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"browser"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"toPixels"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"image"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"canvas"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":39},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            ."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"then"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"output"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":40},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"                console"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"Success\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":41},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            })."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"catch"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"e"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":42},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"                console"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"e"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":43},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            })\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":44},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":45},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            /**\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":46},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"             * Horrai!! you did it,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":47},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"             * you just created a function that runs a GAN on the browser!\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":48},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            */\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":49},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"        })."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"catch"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"e"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":50},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            model"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"dispose"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":51},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"        });\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":52},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    });\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":53},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"To know more check out "},{"type":"element","tag":"a","props":{"href":"https://js.tensorflow.org/api/latest/","rel":["nofollow"]},"children":[{"type":"text","value":"TFJS documentation"}]}]}]},{"type":"element","tag":"h2","props":{"id":"demo"},"children":[{"type":"text","value":"Demo"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you want to test the final product see "},{"type":"element","tag":"a","props":{"href":"https://mahmoudyusof.github.io/projects/digit-image-generator","rel":["nofollow"]},"children":[{"type":"text","value":"this demo"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h2","props":{"id":"that-is-it-congratulations"},"children":[{"type":"text","value":"That is it, CONGRATULATIONS."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now you can use client side inference. I should tell you that this is not recommended for resource demanding models, since they might crash the frontend because they require a lot of memory, so extract light weight models only to the client side."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you have any comments, questions or recommendations please reach out to me at any time, I hope this was helpful."}]},{"type":"element","tag":"h2","props":{"id":"full-code"},"children":[{"type":"text","value":"Full Code"}]},{"type":"element","tag":"pre","props":{"code":"// import the library under the tf namespace\nimport * as tf from \"@tensorflow/tfjs\";\n\nfunction generate(model){\n    // tf.tidy handles garbage collection to prevent any memory leakage\n    tf.tidy(() => {\n        // vector of shape [batch_size, encoding_dim]\n        const random_vector = tf.randomNormal([1, 100]);\n\n        // the label tensor, shape is [batch_size, 1]\n        // I am passing the data type as int32 because I want the funciton to return an int,\n        // however the model accepts float numbers not ints this is why I am casting the tensor.\n        const label = tf.randomUniform([1, 1], 0, 10, \"int32\").cast(\"float32\");\n\n        // generate new image\n        model.execute([random_vector, label]).then(image => {\n            // images are of shape [batch_size, 28, 28]\n            // batch_size here is 1 so we can remove it by squeezing the tensor\n            image = image.squeeze();\n\n            // the output of the model ranges from -1 to 1,\n            // let's make it from 0 to 1 since the next funciton is picky\n            image = tf.div(tf.add(image, tf.scalar(1)), tf.scalar(2))\n\n            // let's now make the image of rank 3 to make it an appropriate image\n            // of shape [28, 28, 1] which means a gray scale image\n            // The second argument of this function is the axis of expansion\n            image = tf.expandDims(image, 2);\n\n            // Let's now resize the image from [28, 28, 1] to [200, 200, 1].\n            image = tf.image.resizeNearestNeighbor(img, [200, 200]);\n\n            // Now let's get the canvas element, that we should create in markup, and write this image to it.\n            const canvas = document.getElementById(\"myCanvas\");\n            \n            tf.browser.toPixels(image, canvas)\n            .then(output => {\n                console.log(\"Success\");\n            }).catch(e => {\n                console.log(e);\n            })\n\n            /**\n             * Horrai!! you did it,\n             * you just created a function that runs a GAN on the browser!\n            */\n        });\n    });\n}\n\n// load the model from localstorage\ntf.fromGraphModel(\"localstorage://saved_model_name\")\n    .then(model => {\n        // success case, run the generate function.\n        generate(model);\n    }).catch(e => {\n        // if you fail, load the model from the server\n        tf.fromGraphModel(\"http://model-server-url/model_directory\")\n            .then(model => {\n            // In the chained \"then call\" save the model in localstorage\n            model.save(\"localstorage://saved_model_name\");\n            \n            // run inference\n            generate(model);\n        }).catch(e => {\n            console.log(\"some unexpected error\");\n            console.log(e);\n        });\n    });\n","filename":"generate-images.js","highlights":[4,5,6,7],"language":"js","meta":"","className":"language-js shiki shiki-themes dark-plus github-dark","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"// import the library under the tf namespace\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" *"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":" as"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0;--shiki-dark:#F97583"},"children":[{"type":"text","value":" from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":" \"@tensorflow/tfjs\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":";\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":["line","highlight"],"line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":"function"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":" generate"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"model"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"){\n"}]}]},{"type":"element","tag":"span","props":{"class":["line","highlight"],"line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"    // tf.tidy handles garbage collection to prevent any memory leakage\n"}]}]},{"type":"element","tag":"span","props":{"class":["line","highlight"],"line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"tidy"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(() "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":["line","highlight"],"line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"        // vector of shape [batch_size, encoding_dim]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":"        const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4FC1FF;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" random_vector"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"randomNormal"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"100"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"]);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"        // the label tensor, shape is [batch_size, 1]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"        // I am passing the data type as int32 because I want the funciton to return an int,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"        // however the model accepts float numbers not ints this is why I am casting the tensor.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":"        const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4FC1FF;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" label"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"randomUniform"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"], "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"10"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"int32\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"cast"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"float32\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"        // generate new image\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"        model"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"execute"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"(["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"random_vector"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"label"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"])."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"then"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"image"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // images are of shape [batch_size, 28, 28]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // batch_size here is 1 so we can remove it by squeezing the tensor\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            image"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" image"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"squeeze"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // the output of the model ranges from -1 to 1,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // let's make it from 0 to 1 since the next funciton is picky\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            image"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"add"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"image"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"scalar"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")), "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"scalar"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // let's now make the image of rank 3 to make it an appropriate image\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // of shape [28, 28, 1] which means a gray scale image\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // The second argument of this function is the axis of expansion\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            image"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"expandDims"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"image"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // Let's now resize the image from [28, 28, 1] to [200, 200, 1].\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            image"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"image"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"resizeNearestNeighbor"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"img"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", ["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"200"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":"200"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"]);\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":32},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":33},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // Now let's get the canvas element, that we should create in markup, and write this image to it.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":34},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":"            const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4FC1FF;--shiki-dark:#79B8FF"},"children":[{"type":"text","value":" canvas"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#F97583"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" document"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"getElementById"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"myCanvas\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":35},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":36},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"browser"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"toPixels"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"image"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"canvas"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":37},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            ."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"then"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"output"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":38},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"                console"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"Success\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":39},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            })."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"catch"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"e"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":40},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"                console"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"e"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":41},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            })\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":42},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":43},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            /**\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":44},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"             * Horrai!! you did it,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":45},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"             * you just created a function that runs a GAN on the browser!\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":46},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            */\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":47},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"        });\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":48},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    });\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":49},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"}\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":50},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":51},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"// load the model from localstorage\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":52},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"fromGraphModel"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"localstorage://saved_model_name\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":53},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    ."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"then"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"model"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":54},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"        // success case, run the generate function.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":55},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"        generate"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"model"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":56},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    })."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"catch"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"e"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":57},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"        // if you fail, load the model from the server\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":58},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"        tf"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"fromGraphModel"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"http://model-server-url/model_directory\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":59},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            ."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"then"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"model"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":60},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // In the chained \"then call\" save the model in localstorage\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":61},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            model"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"save"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"localstorage://saved_model_name\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":62},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":63},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955;--shiki-dark:#6A737D"},"children":[{"type":"text","value":"            // run inference\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":64},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"            generate"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"model"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":65},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"        })."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"catch"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#FFAB70"},"children":[{"type":"text","value":"e"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6;--shiki-dark:#F97583"},"children":[{"type":"text","value":" =>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":" {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":66},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            console"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178;--shiki-dark:#9ECBFF"},"children":[{"type":"text","value":"\"some unexpected error\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":67},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"            console"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA;--shiki-dark:#B392F0"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"e"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":");\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":68},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"        });\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":69},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"},"children":[{"type":"text","value":"    });\n"}]}]}]}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"why","depth":2,"text":"Why?"},{"id":"how","depth":2,"text":"How?","children":[{"id":"installing-tensorflowjs-converter","depth":3,"text":"Installing tensorflowjs-converter"},{"id":"converting-the-saved-model","depth":3,"text":"Converting the saved model"},{"id":"save-the-model-in-the-browser","depth":3,"text":"Save the model in the browser"}]},{"id":"demo","depth":2,"text":"Demo"},{"id":"that-is-it-congratulations","depth":2,"text":"That is it, CONGRATULATIONS."},{"id":"full-code","depth":2,"text":"Full Code"}]}},"_type":"markdown","_id":"content:blog:0.client-side-inference.md","_source":"content","_file":"blog/0.client-side-inference.md","_extension":"md"}
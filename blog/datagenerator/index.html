<!DOCTYPE html><html  lang="en" data-capo=""><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>MJ Blog | Data Generators In Tensorflow</title>
<meta property="og:image" content="/__og-image__/image/blog/datagenerator/og.jpeg">
<meta property="og:image:type" content="image/jpeg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="/__og-image__/image/blog/datagenerator/og.jpeg">
<meta name="twitter:image:src" content="/__og-image__/image/blog/datagenerator/og.jpeg">
<meta property="og:image:width" content="1200">
<meta name="twitter:image:width" content="1200">
<meta property="og:image:height" content="600">
<meta name="twitter:image:height" content="600">
<style>/*! tailwindcss v3.4.4 | MIT License | https://tailwindcss.com*/*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-feature-settings:normal;font-variation-settings:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-tap-highlight-color:transparent}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-size:1em;font-variation-settings:normal}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{color:inherit;font-family:inherit;font-feature-settings:inherit;font-size:100%;font-variation-settings:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]{display:none}h1{font-size:2.25rem;line-height:2.5rem}h1,h2{font-weight:700}h2{font-size:1.875rem;line-height:2.25rem}h3{font-size:1.5rem;font-weight:700;line-height:2rem}h4{font-size:1.25rem}h4,h5{font-weight:700;line-height:1.75rem}h5{font-size:1.125rem}h6{font-size:1rem;font-weight:700;line-height:1.5rem}h1,h2,h3,h4,h5,h6{scroll-margin-top:100px}ol,ul{list-style-position:inside;margin-left:1.5rem}ul{list-style-type:disc}ol{list-style-type:upper-roman}li{margin-bottom:.25rem;margin-top:.25rem}*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}@media (min-width:1536px){.container{max-width:1536px}}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.left-0{left:0}.left-5{left:1.25rem}.top-0{top:0}.top-28{top:7rem}.z-20{z-index:20}.z-30{z-index:30}.z-50{z-index:50}.col-span-10{grid-column:span 10/span 10}.col-span-5{grid-column:span 5/span 5}.col-start-11{grid-column-start:11}.col-end-13{grid-column-end:13}.row-span-1{grid-row:span 1/span 1}.row-start-1{grid-row-start:1}.row-end-3{grid-row-end:3}.mx-1{margin-left:.25rem;margin-right:.25rem}.mx-auto{margin-left:auto;margin-right:auto}.my-2{margin-bottom:.5rem;margin-top:.5rem}.my-4{margin-bottom:1rem;margin-top:1rem}.my-8{margin-bottom:2rem;margin-top:2rem}.\!ml-0{margin-left:0!important}.mb-10{margin-bottom:2.5rem}.mb-3{margin-bottom:.75rem}.mb-36{margin-bottom:9rem}.mb-4{margin-bottom:1rem}.mb-5{margin-bottom:1.25rem}.mb-6{margin-bottom:1.5rem}.mr-2{margin-right:.5rem}.mt-10{margin-top:2.5rem}.mt-2{margin-top:.5rem}.mt-4{margin-top:1rem}.mt-5{margin-top:1.25rem}.block{display:block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-fit{height:-moz-fit-content;height:fit-content}.h-full{height:100%}.h-screen{height:100vh}.min-h-screen{min-height:100vh}.w-full{width:100%}.max-w-56{max-width:14rem}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.animate-spin{animation:spin 1s linear infinite}.cursor-pointer{cursor:pointer}.break-before-avoid{-moz-column-break-before:avoid;break-before:avoid}.break-inside-avoid{-moz-column-break-inside:avoid;break-inside:avoid}.grid-cols-12{grid-template-columns:repeat(12,minmax(0,1fr))}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}.grid-rows-2{grid-template-rows:repeat(2,minmax(0,1fr))}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.justify-start{justify-content:flex-start}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.justify-evenly{justify-content:space-evenly}.gap-4{gap:1rem}.gap-5{gap:1.25rem}.gap-8{gap:2rem}.gap-x-8{-moz-column-gap:2rem;column-gap:2rem}.space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-left:calc(.5rem*(1 - var(--tw-space-x-reverse)));margin-right:calc(.5rem*var(--tw-space-x-reverse))}.space-x-3>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-left:calc(.75rem*(1 - var(--tw-space-x-reverse)));margin-right:calc(.75rem*var(--tw-space-x-reverse))}.space-y-20>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(5rem*var(--tw-space-y-reverse));margin-top:calc(5rem*(1 - var(--tw-space-y-reverse)))}.space-y-24>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(6rem*var(--tw-space-y-reverse));margin-top:calc(6rem*(1 - var(--tw-space-y-reverse)))}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(1rem*var(--tw-space-y-reverse));margin-top:calc(1rem*(1 - var(--tw-space-y-reverse)))}.space-y-5>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(1.25rem*var(--tw-space-y-reverse));margin-top:calc(1.25rem*(1 - var(--tw-space-y-reverse)))}.divide-y-2>:not([hidden])~:not([hidden]){--tw-divide-y-reverse:0;border-bottom-width:calc(2px*var(--tw-divide-y-reverse));border-top-width:calc(2px*(1 - var(--tw-divide-y-reverse)))}.self-center{align-self:center}.text-wrap{text-wrap:wrap}.rounded{border-radius:.25rem}.rounded-2xl{border-radius:1rem}.rounded-3xl{border-radius:1.5rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.rounded-xl{border-radius:.75rem}.rounded-l-3xl{border-bottom-left-radius:1.5rem;border-top-left-radius:1.5rem}.rounded-t-full{border-top-left-radius:9999px;border-top-right-radius:9999px}.rounded-t-lg{border-top-left-radius:.5rem;border-top-right-radius:.5rem}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-l{border-left-width:1px}.border-l-2{border-left-width:2px}.border-l-4{border-left-width:4px}.border-r{border-right-width:1px}.border-t{border-top-width:1px}.border-double{border-style:double}.border-gray-300{--tw-border-opacity:1;border-color:rgb(209 213 219/var(--tw-border-opacity))}.border-gray-50{--tw-border-opacity:1;border-color:rgb(249 250 251/var(--tw-border-opacity))}.border-indigo-500{--tw-border-opacity:1;border-color:rgb(99 102 241/var(--tw-border-opacity))}.border-slate-100{--tw-border-opacity:1;border-color:rgb(241 245 249/var(--tw-border-opacity))}.border-slate-600{--tw-border-opacity:1;border-color:rgb(71 85 105/var(--tw-border-opacity))}.border-violet-300{--tw-border-opacity:1;border-color:rgb(196 181 253/var(--tw-border-opacity))}.border-white{--tw-border-opacity:1;border-color:rgb(255 255 255/var(--tw-border-opacity))}.border-zinc-500{--tw-border-opacity:1;border-color:rgb(113 113 122/var(--tw-border-opacity))}.border-b-zinc-500{--tw-border-opacity:1;border-bottom-color:rgb(113 113 122/var(--tw-border-opacity))}.bg-black{--tw-bg-opacity:1;background-color:rgb(0 0 0/var(--tw-bg-opacity))}.bg-emerald-600{--tw-bg-opacity:1;background-color:rgb(5 150 105/var(--tw-bg-opacity))}.bg-gray-200{--tw-bg-opacity:1;background-color:rgb(229 231 235/var(--tw-bg-opacity))}.bg-gray-800{--tw-bg-opacity:1;background-color:rgb(31 41 55/var(--tw-bg-opacity))}.bg-red-800{--tw-bg-opacity:1;background-color:rgb(153 27 27/var(--tw-bg-opacity))}.bg-slate-800{--tw-bg-opacity:1;background-color:rgb(30 41 59/var(--tw-bg-opacity))}.bg-slate-900{--tw-bg-opacity:1;background-color:rgb(15 23 42/var(--tw-bg-opacity))}.bg-transparent{background-color:transparent}.bg-violet-500{--tw-bg-opacity:1;background-color:rgb(139 92 246/var(--tw-bg-opacity))}.bg-violet-700{--tw-bg-opacity:1;background-color:rgb(109 40 217/var(--tw-bg-opacity))}.bg-yellow-300{--tw-bg-opacity:1;background-color:rgb(253 224 71/var(--tw-bg-opacity))}.bg-zinc-600{--tw-bg-opacity:1;background-color:rgb(82 82 91/var(--tw-bg-opacity))}.bg-zinc-800{--tw-bg-opacity:1;background-color:rgb(39 39 42/var(--tw-bg-opacity))}.bg-zinc-900{--tw-bg-opacity:1;background-color:rgb(24 24 27/var(--tw-bg-opacity))}.bg-zinc-950{--tw-bg-opacity:1;background-color:rgb(9 9 11/var(--tw-bg-opacity))}.bg-gradient-to-r{background-image:linear-gradient(to right,var(--tw-gradient-stops))}.from-indigo-500{--tw-gradient-from:#6366f1 var(--tw-gradient-from-position);--tw-gradient-to:rgba(99,102,241,0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to)}.from-slate-800{--tw-gradient-from:#1e293b var(--tw-gradient-from-position);--tw-gradient-to:rgba(30,41,59,0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to)}.to-indigo-800{--tw-gradient-to:#3730a3 var(--tw-gradient-to-position)}.to-sky-900{--tw-gradient-to:#0c4a6e var(--tw-gradient-to-position)}.object-cover{-o-object-fit:cover;object-fit:cover}.p-10{padding:2.5rem}.p-20{padding:5rem}.p-3{padding:.75rem}.p-5{padding:1.25rem}.px-10{padding-left:2.5rem;padding-right:2.5rem}.px-16{padding-left:4rem;padding-right:4rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-4{padding-left:1rem;padding-right:1rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.py-0{padding-bottom:0;padding-top:0}.py-0\.5{padding-bottom:.125rem;padding-top:.125rem}.py-1{padding-bottom:.25rem;padding-top:.25rem}.py-10{padding-bottom:2.5rem;padding-top:2.5rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.py-3{padding-bottom:.75rem;padding-top:.75rem}.py-5{padding-bottom:1.25rem;padding-top:1.25rem}.py-8{padding-bottom:2rem;padding-top:2rem}.pb-10{padding-bottom:2.5rem}.pl-3{padding-left:.75rem}.pl-5{padding-left:1.25rem}.pt-4{padding-top:1rem}.pt-56{padding-top:14rem}.pt-\[76px\]{padding-top:76px}.text-left{text-align:left}.text-center{text-align:center}.align-middle{vertical-align:middle}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-6xl{font-size:3.75rem;line-height:1}.text-\[60px\]{font-size:60px}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.font-bold{font-weight:700}.italic{font-style:italic}.text-gray-100{--tw-text-opacity:1;color:rgb(243 244 246/var(--tw-text-opacity))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175/var(--tw-text-opacity))}.text-gray-50{--tw-text-opacity:1;color:rgb(249 250 251/var(--tw-text-opacity))}.text-indigo-300{--tw-text-opacity:1;color:rgb(165 180 252/var(--tw-text-opacity))}.text-slate-200{--tw-text-opacity:1;color:rgb(226 232 240/var(--tw-text-opacity))}.text-stone-200{--tw-text-opacity:1;color:rgb(231 229 228/var(--tw-text-opacity))}.text-violet-300{--tw-text-opacity:1;color:rgb(196 181 253/var(--tw-text-opacity))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.text-yellow-500{--tw-text-opacity:1;color:rgb(234 179 8/var(--tw-text-opacity))}.text-zinc-800{--tw-text-opacity:1;color:rgb(39 39 42/var(--tw-text-opacity))}.underline{text-decoration-line:underline}.opacity-75{opacity:.75}.shadow-2xl{--tw-shadow:0 25px 50px -12px rgba(0,0,0,.25);--tw-shadow-colored:0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-violet-800{--tw-shadow-color:#5b21b6;--tw-shadow:var(--tw-shadow-colored)}.blur{--tw-blur:blur(8px)}.blur,.drop-shadow{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow{--tw-drop-shadow:drop-shadow(0 1px 2px rgba(0,0,0,.1)) drop-shadow(0 1px 1px rgba(0,0,0,.06))}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur-3xl{--tw-backdrop-blur:blur(64px)}.backdrop-blur-3xl,.backdrop-brightness-110{-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-brightness-110{--tw-backdrop-brightness:brightness(1.1)}.backdrop-saturate-200{--tw-backdrop-saturate:saturate(2);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-all{transition-duration:.15s;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-colors{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}body{background-color:#18181b;color:#f3f4f6}@keyframes grow{0%{width:0}to{width:50%}}body *{z-index:2}html{color-scheme:dark light;scroll-behavior:smooth}.hover\:scale-105:hover{--tw-scale-x:1.05;--tw-scale-y:1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:bg-violet-950:hover{--tw-bg-opacity:1;background-color:rgb(46 16 101/var(--tw-bg-opacity))}.hover\:py-5:hover{padding-bottom:1.25rem;padding-top:1.25rem}.hover\:text-white:hover{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.hover\:underline:hover{text-decoration-line:underline}.hover\:opacity-100:hover{opacity:1}.focus\:py-5:focus{padding-bottom:1.25rem;padding-top:1.25rem}@keyframes spin{to{transform:rotate(1turn)}}.group:hover .group-hover\:animate-spin{animation:spin 1s linear infinite}@media (min-width:768px){.md\:p-10{padding:2.5rem}}@media (min-width:1024px){.lg\:col-span-1{grid-column:span 1/span 1}.lg\:col-span-3{grid-column:span 3/span 3}.lg\:block{display:block}.lg\:flex{display:flex}.lg\:w-3\/4{width:75%}.lg\:w-3\/5{width:60%}.lg\:grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.lg\:justify-end{justify-content:flex-end}.lg\:gap-14{gap:3.5rem}}@media (min-width:1280px){.xl\:w-1\/2{width:50%}}</style>
<style>.icon[data-v-c8fd01da]{display:inline-block;vertical-align:middle}</style>
<style>#article p{font-size:1.125rem;line-height:1.75rem;margin-bottom:1rem;margin-top:1rem}@media (min-width:768px){article{font-size:1.25rem;line-height:1.75rem}}#article hr{border-radius:9999px;margin-bottom:2rem;margin-top:2rem}#article blockquote{border-left-width:4px;margin-bottom:2rem;margin-top:2rem;--tw-border-opacity:1;border-color:rgb(99 102 241/var(--tw-border-opacity));--tw-bg-opacity:1;background-color:rgb(31 41 55/var(--tw-bg-opacity));padding:.75rem 1rem;--tw-text-opacity:1;color:rgb(209 213 219/var(--tw-text-opacity))}#article blockquote>p{font-size:inherit}#article p>code{border-radius:.25rem;--tw-bg-opacity:1;background-color:rgb(82 82 91/var(--tw-bg-opacity));font-style:italic;padding:.125rem .5rem;--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}article li a,article p a{--tw-text-opacity:1;color:rgb(165 180 252/var(--tw-text-opacity));text-decoration-line:underline}article li a:hover,article p a:hover{--tw-text-opacity:1;color:rgb(99 102 241/var(--tw-text-opacity));text-decoration:none}#article :is(h1,h2,h3,h4,h5,h6){font-weight:700;margin-bottom:1.25rem;margin-top:1.25rem}#article :is(h1,h2,h3,h4,h5,h6):before{color:#6366f1;content:"#";font-weight:lighter;margin-bottom:.75rem;margin-right:.75rem;margin-top:.5rem}</style>
<link rel="preload" as="fetch" crossorigin="anonymous" href="/blog/datagenerator/_payload.json?7ffd862f-afed-4bca-859c-48fc68bcb72b">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/D9TQMOs_.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/tv1EIfLW.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Dr3is3fv.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BFz1t2SC.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DOGpx7Ae.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/aeXd9Axv.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BQkc-AXV.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CE4uUmQs.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BAA-pIsR.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/B5q3F9Jj.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CCiFPYSw.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C-v3KzvZ.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CC92Ra9s.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DVSTn8Df.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CNaiR-oB.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DI6K-GEd.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DI_uihtC.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BvSW_3To.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BPOuBMGQ.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BM2lzj_y.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DmuGqdz4.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CznVFdGY.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DysbSQdK.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/B89_6Xsy.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/cs7Znxy-.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CHKWW6wX.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CKGWAe4F.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/KIxngzBx.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/B-zMD3yI.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DZBshwPU.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C3T4Tj5e.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CxU58qQB.js">
<link rel="prefetch" as="style" href="/_nuxt/useStudio.BLrrQvhe.css">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/B8wLtGE6.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/CmA6IeR0.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/mv_Zox6I.js">
<link rel="icon" type="image/svg" href="/favicon.svg">
<link rel="canonical" href="/blog/datagenerator">
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
<link rel="icon" type="image/svg" href="/favicon.svg">
<meta property="og:title" content="Data Generators In Tensorflow">
<meta name="twitter:title" content="Data Generators In Tensorflow">
<meta name="description" content="explaining how to load batches of data into memory instead of the entire dataset for more effeciency">
<meta property="og:description" content="explaining how to load batches of data into memory instead of the entire dataset for more effeciency">
<meta name="twitter:description" content="explaining how to load batches of data into memory instead of the entire dataset for more effeciency">
<meta property="og:type" content="article">
<script type="module" src="/_nuxt/D9TQMOs_.js" crossorigin></script>
<script id="unhead:payload" type="application/json">{"titleTemplate":"MJ Blog | %s"}</script>
<meta property="og:site_name" content="nuxt-app"></head><body><div id="__nuxt"><!--[--><nav class="bg-white-500/50 flex fixed top-0 py-2 left-0 w-full backdrop-blur-3xl z-50
        backdrop-brightness-110 backdrop-saturate-200 justify-between px-16 align-middle"><div id="logo" class="flex gap-8 justify-center items-center"><a href="/" class=""><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" width="90" height="60" alt="MJ Logo" data-nuxt-img srcset="/_ipx/s_90x60/logo-white.svg 1x, /_ipx/s_180x120/logo-white.svg 2x" style="height:60px;" src="/_ipx/s_90x60/logo-white.svg"></a></div><div class="flex items-center space-x-3"><a href="/" class="" aria-label="Home"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" style="" width="25px" height="25px" viewBox="0 0 24 24" data-v-c8fd01da><path fill="currentColor" d="m20 8l-6-5.26a3 3 0 0 0-4 0L4 8a3 3 0 0 0-1 2.26V19a3 3 0 0 0 3 3h12a3 3 0 0 0 3-3v-8.75A3 3 0 0 0 20 8m-6 12h-4v-5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1Zm5-1a1 1 0 0 1-1 1h-2v-5a3 3 0 0 0-3-3h-2a3 3 0 0 0-3 3v5H6a1 1 0 0 1-1-1v-8.75a1 1 0 0 1 .34-.75l6-5.25a1 1 0 0 1 1.32 0l6 5.25a1 1 0 0 1 .34.75Z"/></svg></a><a target="_blank" href="https://twitter.com/mahmoudyusof" aria-label="twitter"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" style="" width="25px" height="25px" viewBox="0 0 512 512" data-v-c8fd01da><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2L487 464H345L233.7 318.6L106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg></a><a target="_blank" href="https://stackoverflow.com/users/9979796/mahmoud-youssef" aria-label="stackoverflow"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" style="" width="25px" height="25px" viewBox="0 0 384 512" data-v-c8fd01da><path fill="currentColor" d="M290.7 311L95 269.7L86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8l153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 300zM262 32l-32 24l119.3 160.3l32-24zm20.5 328h-200v39.7h200zm39.7 80H42.7V320h-40v160h359.5V320h-40z"/></svg></a><a target="_blank" href="https://www.linkedin.com/in/mahmoud-yusof-a39ab5151/" aria-label="linkedin"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" style="" width="25px" height="25px" viewBox="0 0 448 512" data-v-c8fd01da><path fill="currentColor" d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3M447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2c-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3c94 0 111.28 61.9 111.28 142.3V448z"/></svg></a><a target="_blank" href="mailto:mahmoud.yusof27@gmail.com" aria-label="mail"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" style="" width="25px" height="25px" viewBox="0 0 1792 1408" data-v-c8fd01da><path fill="currentColor" d="M1664 1248V480q-32 36-69 66q-268 206-426 338q-51 43-83 67t-86.5 48.5T897 1024h-2q-48 0-102.5-24.5T706 951t-83-67Q465 752 197 546q-37-30-69-66v768q0 13 9.5 22.5t22.5 9.5h1472q13 0 22.5-9.5t9.5-22.5m0-1051v-24.5l-.5-13l-3-12.5l-5.5-9l-9-7.5l-14-2.5H160q-13 0-22.5 9.5T128 160q0 168 147 284q193 152 401 317q6 5 35 29.5t46 37.5t44.5 31.5T852 887t43 9h2q20 0 43-9t50.5-27.5T1035 828t46-37.5t35-29.5q208-165 401-317q54-43 100.5-115.5T1664 197m128-37v1088q0 66-47 113t-113 47H160q-66 0-113-47T0 1248V160Q0 94 47 47T160 0h1472q66 0 113 47t47 113"/></svg></a></div></nav><div class="pt-[76px]"><!--[--><div id="article" class="border-gray-50 border-t border-b bg-zinc-950 grid grid-cols-5"><div title="Data Generators In Tensorflow" fullpath="/blog/datagenerator"></div><article class="md:p-10 py-10 px-5 lg:col-span-3 col-span-5"><div><h1 id="how-to-use-data-generators-in-tensorflow"><!--[-->How to use data generators in tensorflow<!--]--></h1><hr><h2 id="why"><a href="#why"><!--[-->Why ?<!--]--></a></h2><p><!--[-->Believe it or not, but loading the entire dataset in memory is <strong><!--[-->NOT<!--]--></strong> the best idea.<br>
If you&#39;re dealing with a small dataset, that might work, but that is just a waste of resources, and worse if you&#39;re working on a huge dataset like the imageNet dataset, this won&#39;t work at all.<!--]--></p><h2 id="how"><a href="#how"><!--[-->HOW ?<!--]--></a></h2><p><!--[-->Python generators are lazy which means they are iterables that give you the data upon request, unlike regular lists that just store the data in memory all the time.<!--]--></p><p><!--[-->tensorflow keras has a <code class=""><!--[-->Sequence<!--]--></code> class that can be used for this purpose. <a href="https://www.tensorflow.org/api_docs/python/tf/keras/utils/Sequence" rel="noopener noreferrer" class="mdlink"><!--[-->Sequence Class API Reference<!--]--></a><br>
let&#39;s jump into it<!--]--></p><h2 id="scenario"><a href="#scenario"><!--[-->Scenario<!--]--></a></h2><p><!--[-->Working with images is a good example for this, so let&#39;s say that you have pictures of objects that you need to localize,<br>
So your features are images and labels are (x, y, h, w) for coordinate and dimensions of the containing box, and the labels and image names are stored in a csv file.<!--]--></p><h2 id="data"><a href="#data"><!--[-->Data<!--]--></a></h2>

































<table><!--[--><thead><!--[--><tr><!--[--><th><!--[-->image_file    <!--]--></th><th><!--[-->x    <!--]--></th><th><!--[-->y    <!--]--></th><th><!--[-->w    <!--]--></th><th><!--[-->h    <!--]--></th><!--]--></tr><!--]--></thead><tbody><!--[--><tr><!--[--><td><!--[-->file1.png<!--]--></td><td><!--[-->10<!--]--></td><td><!--[-->20<!--]--></td><td><!--[-->50<!--]--></td><td><!--[-->50<!--]--></td><!--]--></tr><tr><!--[--><td><!--[-->...<!--]--></td><td><!--[-->...<!--]--></td><td><!--[-->...<!--]--></td><td><!--[-->...<!--]--></td><td><!--[-->...<!--]--></td><!--]--></tr><tr><!--[--><td><!--[-->...<!--]--></td><td><!--[-->...<!--]--></td><td><!--[-->...<!--]--></td><td><!--[-->...<!--]--></td><td><!--[-->...<!--]--></td><!--]--></tr><!--]--></tbody><!--]--></table><hr><h2 id="code"><a href="#code"><!--[-->Code<!--]--></a></h2><p><!--[-->Let&#39;s define an initializer, the initializer is going to take the information needed to get the data such as:<!--]--></p><ul><!--[--><li><!--[-->The csv file<!--]--></li><li><!--[-->The directory containing all of the images<!--]--></li><!--]--></ul><p><!--[-->It will also take the output shape of the batch<!--]--></p><ul><!--[--><li><!--[-->The output size of each image<!--]--></li><li><!--[-->The batch size<!--]--></li><!--]--></ul><div class="bg-zinc-900 border border-zinc-500 my-2" style=""><!----><pre class="p-5 language-python shiki shiki-themes dark-plus github-dark text-wrap"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">import</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> numpy </span><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">as</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> np
</span></span><span class="line" line="2"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">import</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> pandas </span><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">as</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> pd
</span></span><span class="line" line="3"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">import</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> matplotlib.image </span><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">as</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> mpimg
</span></span><span class="line" line="4"><span emptylineplaceholder="true">
</span></span><span class="line" line="5"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">from</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> tensorflow.keras.utils </span><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">import</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> Sequence
</span></span><span class="line" line="6"><span emptylineplaceholder="true">
</span></span><span class="line" line="7"><span style="--shiki-default:#569CD6;--shiki-dark:#F97583">class</span><span style="--shiki-default:#4EC9B0;--shiki-dark:#B392F0"> DataGenerator</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(</span><span style="--shiki-default:#4EC9B0;--shiki-dark:#B392F0">Sequence</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">):
</span></span><span class="line" line="8"><span emptylineplaceholder="true">
</span></span><span class="line" line="9"><span style="--shiki-default:#569CD6;--shiki-dark:#F97583">  def</span><span style="--shiki-default:#DCDCAA;--shiki-dark:#79B8FF"> __init__</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(</span><span style="--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8">csv_file</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8">base_dir</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8">output_size</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8">shuffle</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">False</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8">batch_size</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF">10</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">):
</span></span><span class="line" line="10"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">  &quot;&quot;&quot;
</span></span><span class="line" line="11"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">  Initializes a data generator object
</span></span><span class="line" line="12"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">    :param csv_file: file in which image names and numeric labels are stored
</span></span><span class="line" line="13"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">    :param base_dir: the directory in which all images are stored
</span></span><span class="line" line="14"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">    :param output_size: image output size after preprocessing
</span></span><span class="line" line="15"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">    :param shuffle: shuffle the data after each epoch
</span></span><span class="line" line="16"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">    :param batch_size: The size of each batch returned by __getitem__
</span></span><span class="line" line="17"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">  &quot;&quot;&quot;
</span></span><span class="line" line="18"><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">    self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.df </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> pd.read_csv(csv_file)
</span></span><span class="line" line="19"><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">    self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.base_dir </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> base_dir
</span></span><span class="line" line="20"><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">    self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.output_size </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> output_size
</span></span><span class="line" line="21"><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">    self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.shuffle </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> shuffle
</span></span><span class="line" line="22"><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">    self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.batch_size </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> batch_size
</span></span><span class="line" line="23"><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">    self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.on_epoch_end()
</span></span></code><!--]--></pre></div><hr><p><!--[-->Now let&#39;s define some special methods starting with the one called in the initializer <code class=""><!--[-->on_epoch_end()<!--]--></code> that is called after each epoch as the name may suggest, duh!<!--]--></p><p><!--[-->We call this method in the initializer because we need the indeces attribute to be set at the begining of the first epoch, otherwise we will get an error telling us that the class has no attribute &quot;indecies&quot;<!--]--></p><div class="bg-zinc-900 border border-zinc-500 my-2" style=""><!----><pre class="p-5 language-python shiki shiki-themes dark-plus github-dark text-wrap"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#569CD6;--shiki-dark:#F97583">def</span><span style="--shiki-default:#DCDCAA;--shiki-dark:#B392F0"> on_epoch_end</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(</span><span style="--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">):
</span></span><span class="line" line="2"><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">  self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.indices </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> np.arange(</span><span style="--shiki-default:#DCDCAA;--shiki-dark:#79B8FF">len</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.df))
</span></span><span class="line" line="3"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">  if</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF"> self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.shuffle:
</span></span><span class="line" line="4"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    np.random.shuffle(</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.indices)
</span></span></code><!--]--></pre></div><hr><p><!--[-->Now we need to define the length of the data, which is not the number of entries as you might think, it&#39;s actually the number of batches, this needs to be accessible by the <code class=""><!--[-->len<!--]--></code> function in python so we need to define the <code class=""><!--[-->__len__<!--]--></code> method.<!--]--></p><div class="bg-zinc-900 border border-zinc-500 my-2" style=""><!----><pre class="p-5 language-python shiki shiki-themes dark-plus github-dark text-wrap"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#569CD6;--shiki-dark:#F97583">def</span><span style="--shiki-default:#DCDCAA;--shiki-dark:#79B8FF"> __len__</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(</span><span style="--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">):
</span></span><span class="line" line="2"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">  return</span><span style="--shiki-default:#4EC9B0;--shiki-dark:#79B8FF"> int</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(</span><span style="--shiki-default:#DCDCAA;--shiki-dark:#79B8FF">len</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.df) </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">/</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF"> self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.batch_size)
</span></span></code><!--]--></pre></div><hr><p><!--[-->Now let&#39;s get serious, the fun part is in the next method which is <code class=""><!--[-->__getitem__<!--]--></code>.<br>
This function gets called on indexing or slicing like <code class=""><!--[-->data_generator[0]<!--]--></code> or <code class=""><!--[-->data_generator[1:3]<!--]--></code> and the index is passed as a parameter to it. Here we call it <code class=""><!--[-->idx<!--]--></code><!--]--></p><p><!--[-->In this function we shall load and preprocess the images.<br>
This will only be fired when keras trys to load a batch, which will save our memory.<!--]--></p><p><!--[-->You might think splitting this into multiple functions would be a good idea ... and you&#39;d be totally right.<br>
This function should return a preprocessed batch of data<!--]--></p><div class="bg-zinc-900 border border-zinc-500 my-2" style=""><!----><pre class="p-5 language-python shiki shiki-themes dark-plus github-dark text-wrap"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#569CD6;--shiki-dark:#F97583">def</span><span style="--shiki-default:#DCDCAA;--shiki-dark:#79B8FF"> __getitem__</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(</span><span style="--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8">idx</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">):
</span></span><span class="line" line="2"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">  ## Initializing Batch
</span></span><span class="line" line="3"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">  #  that one in the shape is just for a one channel images
</span></span><span class="line" line="4"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">  # if you want to use colored images you might want to set that to 3
</span></span><span class="line" line="5"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">  X </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> np.empty((</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.batch_size, </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">*</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.output_size, </span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF">1</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">))
</span></span><span class="line" line="6"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">  # (x, y, h, w)
</span></span><span class="line" line="7"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">  y </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> np.empty((</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.batch_size, </span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF">4</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF">1</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">))
</span></span><span class="line" line="8"><span emptylineplaceholder="true">
</span></span><span class="line" line="9"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">  # get the indices of the requested batch
</span></span><span class="line" line="10"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">  indices </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF"> self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.indices[idx</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">*</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.batch_size:(idx</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">+</span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF">1</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">)</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">*</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.batch_size]
</span></span><span class="line" line="11"><span emptylineplaceholder="true">
</span></span><span class="line" line="12"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">  for</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> i, data_index </span><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">in</span><span style="--shiki-default:#DCDCAA;--shiki-dark:#79B8FF"> enumerate</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(indices):
</span></span><span class="line" line="13"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    img_path </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> os.path.join(</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.base_dir,
</span></span><span class="line" line="14"><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">                self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.df.iloc[data_index, </span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF">0</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">])
</span></span><span class="line" line="15"><span emptylineplaceholder="true">
</span></span><span class="line" line="16"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    img </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> mpimg.imread()
</span></span><span class="line" line="17"><span emptylineplaceholder="true">
</span></span><span class="line" line="18"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">    ## this is where you preprocess the image
</span></span><span class="line" line="19"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">    ## make sure to resize it to be self.output_size
</span></span><span class="line" line="20"><span emptylineplaceholder="true">
</span></span><span class="line" line="21"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    label </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF"> self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.df.iloc[data_index, </span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF">1</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">:].to_numpy()
</span></span><span class="line" line="22"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">    ## if you have any preprocessing for
</span></span><span class="line" line="23"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">    ## the labels too do it here
</span></span><span class="line" line="24"><span emptylineplaceholder="true">
</span></span><span class="line" line="25"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    X[i,] </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> img
</span></span><span class="line" line="26"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    y[i] </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> label
</span></span><span class="line" line="27"><span emptylineplaceholder="true">
</span></span><span class="line" line="28"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">  return</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> X, y
</span></span></code><!--]--></pre></div><hr><p><!--[-->Now you are ready to fit the model to this generator. You can also easily make a validation generator and validate your model against that, all you need to do is make a new instance of the <code class=""><!--[-->DataGenerator<!--]--></code> class, and pass in the validation csv and base directory and you&#39;re good to go. That&#39;s why I love OOP.<!--]--></p><div class="bg-zinc-900 border border-zinc-500 my-2" style=""><!----><pre class="p-5 language-python shiki shiki-themes dark-plus github-dark text-wrap"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">from</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> tensorflow.keras.models </span><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">import</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> Sequential
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">model </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> Sequential([
</span></span><span class="line" line="4"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">  ## define the model&#39;s architecture
</span></span><span class="line" line="5"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">])
</span></span><span class="line" line="6"><span emptylineplaceholder="true">
</span></span><span class="line" line="7"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">train_gen </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> DataGenerator(</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;data.csv&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">,
</span></span><span class="line" line="8"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">                          &quot;data&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">,
</span></span><span class="line" line="9"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">                          (</span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF">244</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF">244</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">),
</span></span><span class="line" line="10"><span style="--shiki-default:#9CDCFE;--shiki-dark:#FFAB70">                          batch_size</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF">20</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">,
</span></span><span class="line" line="11"><span style="--shiki-default:#9CDCFE;--shiki-dark:#FFAB70">                          shuffle</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">True</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">)
</span></span><span class="line" line="12"><span emptylineplaceholder="true">
</span></span><span class="line" line="13"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">## compile the model first of course
</span></span><span class="line" line="14"><span emptylineplaceholder="true">
</span></span><span class="line" line="15"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D"># now let&#39;s train the model
</span></span><span class="line" line="16"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">model.fit(train_gen, </span><span style="--shiki-default:#9CDCFE;--shiki-dark:#FFAB70">epochs</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF">5</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#79B8FF">...</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">)
</span></span><span class="line" line="17"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">#  note you could also make a validation generator and pass it here like normal datasets
</span></span><span class="line" line="18"><span emptylineplaceholder="true">
</span></span><span class="line" line="19"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D"># back in the days you had to do this
</span></span><span class="line" line="20"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D"># model.fit_generator(train_gen, ...)
</span></span></code><!--]--></pre></div><hr><h2 id="the-complete-code"><a href="#the-complete-code"><!--[-->The complete code<!--]--></a></h2><div class="bg-zinc-900 border border-zinc-500 my-2" style=""><!----><pre class="p-5 language-python shiki shiki-themes dark-plus github-dark text-wrap"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#569CD6;--shiki-dark:#F97583">class</span><span style="--shiki-default:#4EC9B0;--shiki-dark:#B392F0"> DataGenerator</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(</span><span style="--shiki-default:#4EC9B0;--shiki-dark:#B392F0">Sequence</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">):
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span style="--shiki-default:#569CD6;--shiki-dark:#F97583">  def</span><span style="--shiki-default:#DCDCAA;--shiki-dark:#79B8FF"> __init__</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(</span><span style="--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8">csv_file</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8">base_dir</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8">output_size</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8">shuffle</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">False</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8">batch_size</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF">10</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">):
</span></span><span class="line" line="4"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">    &quot;&quot;&quot;
</span></span><span class="line" line="5"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">    Initializes a data generator object
</span></span><span class="line" line="6"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">      :param csv_file: file in which image names and numeric labels are stored
</span></span><span class="line" line="7"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">      :param base_dir: the directory in which all images are stored
</span></span><span class="line" line="8"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">      :param output_size: image output size after preprocessing
</span></span><span class="line" line="9"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">      :param shuffle: shuffle the data after each epoch
</span></span><span class="line" line="10"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">      :param batch_size: The size of each batch returned by __getitem__
</span></span><span class="line" line="11"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">    &quot;&quot;&quot;
</span></span><span class="line" line="12"><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">    self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.df </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> pd.read_csv(csv_file)
</span></span><span class="line" line="13"><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">    self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.base_dir </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> base_dir
</span></span><span class="line" line="14"><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">    self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.output_size </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> output_size
</span></span><span class="line" line="15"><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">    self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.shuffle </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> shuffle
</span></span><span class="line" line="16"><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">    self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.batch_size </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> batch_size
</span></span><span class="line" line="17"><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">    self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.on_epoch_end()
</span></span><span class="line" line="18"><span emptylineplaceholder="true">
</span></span><span class="line" line="19"><span style="--shiki-default:#569CD6;--shiki-dark:#F97583">  def</span><span style="--shiki-default:#DCDCAA;--shiki-dark:#B392F0"> on_epoch_end</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(</span><span style="--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">):
</span></span><span class="line" line="20"><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">    self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.indices </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> np.arange(</span><span style="--shiki-default:#DCDCAA;--shiki-dark:#79B8FF">len</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.df))
</span></span><span class="line" line="21"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">    if</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF"> self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.shuffle:
</span></span><span class="line" line="22"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">      np.random.shuffle(</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.indices)
</span></span><span class="line" line="23"><span emptylineplaceholder="true">
</span></span><span class="line" line="24"><span style="--shiki-default:#569CD6;--shiki-dark:#F97583">  def</span><span style="--shiki-default:#DCDCAA;--shiki-dark:#79B8FF"> __len__</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(</span><span style="--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">):
</span></span><span class="line" line="25"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">    return</span><span style="--shiki-default:#4EC9B0;--shiki-dark:#79B8FF"> int</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(</span><span style="--shiki-default:#DCDCAA;--shiki-dark:#79B8FF">len</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.df) </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">/</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF"> self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.batch_size)
</span></span><span class="line" line="26"><span emptylineplaceholder="true">
</span></span><span class="line" line="27"><span style="--shiki-default:#569CD6;--shiki-dark:#F97583">  def</span><span style="--shiki-default:#DCDCAA;--shiki-dark:#79B8FF"> __getitem__</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(</span><span style="--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#9CDCFE;--shiki-dark:#E1E4E8">idx</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">):
</span></span><span class="line" line="28"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">    ## Initializing Batch
</span></span><span class="line" line="29"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">    #  that one in the shape is just for a one channel images
</span></span><span class="line" line="30"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">    # if you want to use colored images you might want to set that to 3
</span></span><span class="line" line="31"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    X </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> np.empty((</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.batch_size, </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">*</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.output_size, </span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF">1</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">))
</span></span><span class="line" line="32"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">    # (x, y, h, w)
</span></span><span class="line" line="33"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    y </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> np.empty((</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.batch_size, </span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF">4</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF">1</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">))
</span></span><span class="line" line="34"><span emptylineplaceholder="true">
</span></span><span class="line" line="35"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">    # get the indices of the requested batch
</span></span><span class="line" line="36"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    indices </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF"> self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.indices[idx</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">*</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.batch_size:(idx</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">+</span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF">1</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">)</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">*</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.batch_size]
</span></span><span class="line" line="37"><span emptylineplaceholder="true">
</span></span><span class="line" line="38"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">    for</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> i, data_index </span><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">in</span><span style="--shiki-default:#DCDCAA;--shiki-dark:#79B8FF"> enumerate</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(indices):
</span></span><span class="line" line="39"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">      img_path </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> os.path.join(</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.base_dir,
</span></span><span class="line" line="40"><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">                  self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.df.iloc[data_index, </span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF">0</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">])
</span></span><span class="line" line="41"><span emptylineplaceholder="true">
</span></span><span class="line" line="42"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">      img </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> mpimg.imread()
</span></span><span class="line" line="43"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">      img </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> cv2.cvtColor(img, cv2.</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#79B8FF">COLOR_RGB2GRAY</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">) </span><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D"># to reduce it to one channel to match the shape
</span></span><span class="line" line="44"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">      ## this is where you preprocess the image
</span></span><span class="line" line="45"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">      ## make sure to resize it to be self.output_size
</span></span><span class="line" line="46"><span emptylineplaceholder="true">
</span></span><span class="line" line="47"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">      label </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF"> self</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">.df.iloc[data_index, </span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF">1</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">:].to_numpy()
</span></span><span class="line" line="48"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">      ## if you have any preprocessing for
</span></span><span class="line" line="49"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">      ## the labels too do it here
</span></span><span class="line" line="50"><span emptylineplaceholder="true">
</span></span><span class="line" line="51"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">      X[i,] </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> img
</span></span><span class="line" line="52"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">      y[i] </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> label
</span></span><span class="line" line="53"><span emptylineplaceholder="true">
</span></span><span class="line" line="54"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">    return</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> X, y
</span></span><span class="line" line="55"><span emptylineplaceholder="true">
</span></span><span class="line" line="56"><span emptylineplaceholder="true">
</span></span><span class="line" line="57"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">## Defining and training the model
</span></span><span class="line" line="58"><span emptylineplaceholder="true">
</span></span><span class="line" line="59"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">model </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> Sequential([
</span></span><span class="line" line="60"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">  ## define the model&#39;s architecture
</span></span><span class="line" line="61"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">])
</span></span><span class="line" line="62"><span emptylineplaceholder="true">
</span></span><span class="line" line="63"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">train_gen </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> DataGenerator(</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;data.csv&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;data&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, (</span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF">244</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF">244</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">), </span><span style="--shiki-default:#9CDCFE;--shiki-dark:#FFAB70">batch_size</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF">20</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#9CDCFE;--shiki-dark:#FFAB70">shuffle</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">True</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">)
</span></span><span class="line" line="64"><span emptylineplaceholder="true">
</span></span><span class="line" line="65"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">## compile the model first of course
</span></span><span class="line" line="66"><span emptylineplaceholder="true">
</span></span><span class="line" line="67"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D"># now let&#39;s train the model
</span></span><span class="line" line="68"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">model.fit(train_gen, </span><span style="--shiki-default:#9CDCFE;--shiki-dark:#FFAB70">epochs</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF">5</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#79B8FF">...</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">)
</span></span></code><!--]--></pre></div><hr><p><!--[-->And that&#39;s it.. you&#39;ve just created your dataset generator that loads the data into memory batch by batch instead of the whole thing at once.<br>
I hope this was useful.<!--]--></p><hr><p><!--[--><a href="https://stanford.edu/~shervine/blog/keras-how-to-generate-data-on-the-fly" rel="noopener noreferrer" class="mdlink"><!--[-->Reference Article<!--]--></a><!--]--></p><p><!--[--><a href="https://github.com/mahmoudyusof/facial_keypoint_detection" rel="noopener noreferrer" class="mdlink"><!--[-->My Notebooks<!--]--></a><!--]--></p><style>html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}</style></div></article><div class="border-l border-double border-gray-300 pt-4 lg:col-span-1 lg:block hidden"><span class="sticky top-28"><ul style="list-style-type:none;"><!--[--><li><a aria-current="page" href="/blog/datagenerator#why" class="text-white router-link-exact-active hover:underline text-slate-200 hover:text-white"># Why ?</a><!----></li><li><a aria-current="page" href="/blog/datagenerator#how" class="text-white router-link-exact-active hover:underline text-slate-200 hover:text-white"># HOW ?</a><!----></li><li><a aria-current="page" href="/blog/datagenerator#scenario" class="text-white router-link-exact-active hover:underline text-slate-200 hover:text-white"># Scenario</a><!----></li><li><a aria-current="page" href="/blog/datagenerator#data" class="text-white router-link-exact-active hover:underline text-slate-200 hover:text-white"># Data</a><!----></li><li><a aria-current="page" href="/blog/datagenerator#code" class="text-white router-link-exact-active hover:underline text-slate-200 hover:text-white"># Code</a><!----></li><li><a aria-current="page" href="/blog/datagenerator#the-complete-code" class="text-white router-link-exact-active hover:underline text-slate-200 hover:text-white"># The complete code</a><!----></li><!--]--></ul></span></div></div><!--]--></div><footer class="bg-black py-8 gap-4 text-white flex flex-col justify-center items-center"><p class="">© 2024 Designed and Created by ... well, you can guess</p><div class="space-x-2"><a class="text-gray-400 hover:text-white transition-colors" aria-label="Twitter @mahmoudyusof" target="_blank" href="https://twitter.com/mahmoudyusof"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon mr-2" style="" width="25px" height="25px" viewBox="0 0 512 512" data-v-c8fd01da><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2L487 464H345L233.7 318.6L106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg></a><a class="text-gray-400 hover:text-white transition-colors" aria-label="Stackoverflow 9979796/mahmoud-youssef" target="_blank" href="https://stackoverflow.com/users/9979796/mahmoud-youssef"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon mr-2" style="" width="25px" height="25px" viewBox="0 0 24 24" data-v-c8fd01da><path fill="currentColor" d="M17.36 20.2v-5.38h1.79V22H3v-7.18h1.8v5.38zM6.77 14.32l.37-1.76l8.79 1.85l-.37 1.76zm1.16-4.21l.76-1.61l8.14 3.78l-.76 1.62zm2.26-3.99l1.15-1.38l6.9 5.76l-1.15 1.37zm4.45-4.25L20 9.08l-1.44 1.07l-5.36-7.21zM6.59 18.41v-1.8h8.98v1.8z"/></svg></a><a class="text-gray-400 hover:text-white transition-colors" aria-label="Linkedin mahmoud-yusof-a39ab5151" target="_blank" href="https://www.linkedin.com/in/mahmoud-yusof-a39ab5151/"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon mr-2" style="" width="25px" height="25px" viewBox="0 0 448 512" data-v-c8fd01da><path fill="currentColor" d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3M447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2c-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3c94 0 111.28 61.9 111.28 142.3V448z"/></svg></a><a class="text-gray-400 hover:text-white transition-colors" aria-label="email mahmoud.yusof27@gmail.com" href="mailto:mahmoud.yusof27@gmail.com"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon mr-2" style="" width="25px" height="25px" viewBox="0 0 1792 1408" data-v-c8fd01da><path fill="currentColor" d="M1664 1248V480q-32 36-69 66q-268 206-426 338q-51 43-83 67t-86.5 48.5T897 1024h-2q-48 0-102.5-24.5T706 951t-83-67Q465 752 197 546q-37-30-69-66v768q0 13 9.5 22.5t22.5 9.5h1472q13 0 22.5-9.5t9.5-22.5m0-1051v-24.5l-.5-13l-3-12.5l-5.5-9l-9-7.5l-14-2.5H160q-13 0-22.5 9.5T128 160q0 168 147 284q193 152 401 317q6 5 35 29.5t46 37.5t44.5 31.5T852 887t43 9h2q20 0 43-9t50.5-27.5T1035 828t46-37.5t35-29.5q208-165 401-317q54-43 100.5-115.5T1664 197m128-37v1088q0 66-47 113t-113 47H160q-66 0-113-47T0 1248V160Q0 94 47 47T160 0h1472q66 0 113 47t47 113"/></svg></a></div></footer><!--]--></div><div id="teleports"></div><script id="nuxt-og-image-options" type="application/json">{"component":"OgImageBlogPost","props":{"logo":"/logo-white.svg","title":"Data Generators In Tensorflow"},"_query":{}}</script>
<script type="application/json" id="__NUXT_DATA__" data-ssr="true" data-src="/blog/datagenerator/_payload.json?7ffd862f-afed-4bca-859c-48fc68bcb72b">[{"state":1,"once":27,"_errors":28,"serverRendered":31,"path":32,"prerenderedAt":33},["Reactive",2],{"$sicons":3,"$ssite-config":24},{"uil:home-alt":4,"fa6-brands:x-twitter":9,"fa6-brands:stack-overflow":12,"fa6-brands:linkedin-in":15,"fa:envelope-o":18,"mdi:stack-overflow":22},{"left":5,"top":5,"width":6,"height":6,"rotate":5,"vFlip":7,"hFlip":7,"body":8},0,24,false,"\u003Cpath fill=\"currentColor\" d=\"m20 8l-6-5.26a3 3 0 0 0-4 0L4 8a3 3 0 0 0-1 2.26V19a3 3 0 0 0 3 3h12a3 3 0 0 0 3-3v-8.75A3 3 0 0 0 20 8m-6 12h-4v-5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1Zm5-1a1 1 0 0 1-1 1h-2v-5a3 3 0 0 0-3-3h-2a3 3 0 0 0-3 3v5H6a1 1 0 0 1-1-1v-8.75a1 1 0 0 1 .34-.75l6-5.25a1 1 0 0 1 1.32 0l6 5.25a1 1 0 0 1 .34.75Z\"/>",{"left":5,"top":5,"width":10,"height":10,"rotate":5,"vFlip":7,"hFlip":7,"body":11},512,"\u003Cpath fill=\"currentColor\" d=\"M389.2 48h70.6L305.6 224.2L487 464H345L233.7 318.6L106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z\"/>",{"left":5,"top":5,"width":13,"height":10,"rotate":5,"vFlip":7,"hFlip":7,"body":14},384,"\u003Cpath fill=\"currentColor\" d=\"M290.7 311L95 269.7L86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8l153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 300zM262 32l-32 24l119.3 160.3l32-24zm20.5 328h-200v39.7h200zm39.7 80H42.7V320h-40v160h359.5V320h-40z\"/>",{"left":5,"top":5,"width":16,"height":10,"rotate":5,"vFlip":7,"hFlip":7,"body":17},448,"\u003Cpath fill=\"currentColor\" d=\"M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3M447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2c-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3c94 0 111.28 61.9 111.28 142.3V448z\"/>",{"left":5,"top":5,"width":19,"height":20,"rotate":5,"vFlip":7,"hFlip":7,"body":21},1792,1408,"\u003Cpath fill=\"currentColor\" d=\"M1664 1248V480q-32 36-69 66q-268 206-426 338q-51 43-83 67t-86.5 48.5T897 1024h-2q-48 0-102.5-24.5T706 951t-83-67Q465 752 197 546q-37-30-69-66v768q0 13 9.5 22.5t22.5 9.5h1472q13 0 22.5-9.5t9.5-22.5m0-1051v-24.5l-.5-13l-3-12.5l-5.5-9l-9-7.5l-14-2.5H160q-13 0-22.5 9.5T128 160q0 168 147 284q193 152 401 317q6 5 35 29.5t46 37.5t44.5 31.5T852 887t43 9h2q20 0 43-9t50.5-27.5T1035 828t46-37.5t35-29.5q208-165 401-317q54-43 100.5-115.5T1664 197m128-37v1088q0 66-47 113t-113 47H160q-66 0-113-47T0 1248V160Q0 94 47 47T160 0h1472q66 0 113 47t47 113\"/>",{"left":5,"top":5,"width":6,"height":6,"rotate":5,"vFlip":7,"hFlip":7,"body":23},"\u003Cpath fill=\"currentColor\" d=\"M17.36 20.2v-5.38h1.79V22H3v-7.18h1.8v5.38zM6.77 14.32l.37-1.76l8.79 1.85l-.37 1.76zm1.16-4.21l.76-1.61l8.14 3.78l-.76 1.62zm2.26-3.99l1.15-1.38l6.9 5.76l-1.15 1.37zm4.45-4.25L20 9.08l-1.44 1.07l-5.36-7.21zM6.59 18.41v-1.8h8.98v1.8z\"/>",{"env":25,"name":26},"production","nuxt-app",["Set"],["ShallowReactive",29],{"my-page":30},null,true,"/blog/datagenerator",1718374936368]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{mdc:{components:{prose:true,map:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"}},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}}},content:{locales:[],defaultLocale:"",integrity:1718374897941,experimental:{stripQueryParameters:false,advanceQuery:false,clientDB:false},respectPathCase:false,api:{baseURL:"/api/_content"},navigation:{fields:["date"]},tags:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},highlight:{langs:["javascript","python","shell","typescript","json","yaml","css","html","markdown","bash","dockerfile","vue"],theme:{default:"dark-plus",dark:"github-dark"},highlighter:"shiki"},wsUrl:"",documentDriven:false,host:"",trailingSlash:false,search:"",contentHead:true,anchorLinks:{depth:4,exclude:[1]}},studio:{apiURL:"https://api.nuxt.studio",iframeMessagingAllowedOrigins:""}},app:{baseURL:"/",buildId:"7ffd862f-afed-4bca-859c-48fc68bcb72b",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script>
<script type="application/ld+json" id="schema-org-graph" data-hid="3437552">{"@context":"https://schema.org","@graph":[{"@id":"#website","@type":"WebSite","name":"nuxt-app"},{"@id":"/blog/datagenerator/#webpage","@type":"WebPage","description":"explaining how to load batches of data into memory instead of the entire dataset for more effeciency","name":"Data Generators In Tensorflow","url":"/blog/datagenerator","isPartOf":{"@id":"#website"},"potentialAction":[{"@type":"ReadAction","target":["/blog/datagenerator"]}]}]}</script></body></html>
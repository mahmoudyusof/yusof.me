<!DOCTYPE html><html  lang="en" data-capo=""><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>MJ Blog | A Comprehensive Guide For scikit-learn Pipelines</title>
<meta property="og:image" content="/__og-image__/image/blog/scikit-learn-pipelines/og.png">
<meta property="og:image:type" content="image/png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="/__og-image__/image/blog/scikit-learn-pipelines/og.png">
<meta name="twitter:image:src" content="/__og-image__/image/blog/scikit-learn-pipelines/og.png">
<meta property="og:image:width" content="1200">
<meta name="twitter:image:width" content="1200">
<meta property="og:image:height" content="600">
<meta name="twitter:image:height" content="600">
<style>/*! tailwindcss v3.4.4 | MIT License | https://tailwindcss.com*/*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-feature-settings:normal;font-variation-settings:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-tap-highlight-color:transparent}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-size:1em;font-variation-settings:normal}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{color:inherit;font-family:inherit;font-feature-settings:inherit;font-size:100%;font-variation-settings:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]{display:none}h1{font-size:2.25rem;line-height:2.5rem}h1,h2{font-weight:700}h2{font-size:1.875rem;line-height:2.25rem}h3{font-size:1.5rem;font-weight:700;line-height:2rem}h4{font-size:1.25rem}h4,h5{font-weight:700;line-height:1.75rem}h5{font-size:1.125rem}h6{font-size:1rem;font-weight:700;line-height:1.5rem}h1,h2,h3,h4,h5,h6{scroll-margin-top:100px}ol,ul{list-style-position:inside;margin-left:1.5rem}ul{list-style-type:disc}ol{list-style-type:upper-roman}li{margin-bottom:.25rem;margin-top:.25rem}*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}@media (min-width:1536px){.container{max-width:1536px}}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.left-0{left:0}.left-5{left:1.25rem}.top-0{top:0}.top-28{top:7rem}.z-20{z-index:20}.z-30{z-index:30}.z-50{z-index:50}.col-span-10{grid-column:span 10/span 10}.col-span-5{grid-column:span 5/span 5}.col-start-11{grid-column-start:11}.col-end-13{grid-column-end:13}.row-span-1{grid-row:span 1/span 1}.row-start-1{grid-row-start:1}.row-end-3{grid-row-end:3}.mx-1{margin-left:.25rem;margin-right:.25rem}.mx-auto{margin-left:auto;margin-right:auto}.my-2{margin-bottom:.5rem;margin-top:.5rem}.my-4{margin-bottom:1rem;margin-top:1rem}.my-8{margin-bottom:2rem;margin-top:2rem}.\!ml-0{margin-left:0!important}.mb-10{margin-bottom:2.5rem}.mb-3{margin-bottom:.75rem}.mb-36{margin-bottom:9rem}.mb-4{margin-bottom:1rem}.mb-5{margin-bottom:1.25rem}.mb-6{margin-bottom:1.5rem}.mr-2{margin-right:.5rem}.mt-10{margin-top:2.5rem}.mt-2{margin-top:.5rem}.mt-4{margin-top:1rem}.mt-5{margin-top:1.25rem}.block{display:block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-fit{height:-moz-fit-content;height:fit-content}.h-full{height:100%}.h-screen{height:100vh}.min-h-screen{min-height:100vh}.w-full{width:100%}.max-w-56{max-width:14rem}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.animate-spin{animation:spin 1s linear infinite}.cursor-pointer{cursor:pointer}.break-before-avoid{-moz-column-break-before:avoid;break-before:avoid}.break-inside-avoid{-moz-column-break-inside:avoid;break-inside:avoid}.grid-cols-12{grid-template-columns:repeat(12,minmax(0,1fr))}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}.grid-rows-2{grid-template-rows:repeat(2,minmax(0,1fr))}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.justify-start{justify-content:flex-start}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.justify-evenly{justify-content:space-evenly}.gap-4{gap:1rem}.gap-5{gap:1.25rem}.gap-8{gap:2rem}.gap-x-8{-moz-column-gap:2rem;column-gap:2rem}.space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-left:calc(.5rem*(1 - var(--tw-space-x-reverse)));margin-right:calc(.5rem*var(--tw-space-x-reverse))}.space-x-3>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-left:calc(.75rem*(1 - var(--tw-space-x-reverse)));margin-right:calc(.75rem*var(--tw-space-x-reverse))}.space-y-20>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(5rem*var(--tw-space-y-reverse));margin-top:calc(5rem*(1 - var(--tw-space-y-reverse)))}.space-y-24>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(6rem*var(--tw-space-y-reverse));margin-top:calc(6rem*(1 - var(--tw-space-y-reverse)))}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(1rem*var(--tw-space-y-reverse));margin-top:calc(1rem*(1 - var(--tw-space-y-reverse)))}.space-y-5>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(1.25rem*var(--tw-space-y-reverse));margin-top:calc(1.25rem*(1 - var(--tw-space-y-reverse)))}.divide-y-2>:not([hidden])~:not([hidden]){--tw-divide-y-reverse:0;border-bottom-width:calc(2px*var(--tw-divide-y-reverse));border-top-width:calc(2px*(1 - var(--tw-divide-y-reverse)))}.self-center{align-self:center}.text-wrap{text-wrap:wrap}.rounded{border-radius:.25rem}.rounded-2xl{border-radius:1rem}.rounded-3xl{border-radius:1.5rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.rounded-xl{border-radius:.75rem}.rounded-l-3xl{border-bottom-left-radius:1.5rem;border-top-left-radius:1.5rem}.rounded-t-full{border-top-left-radius:9999px;border-top-right-radius:9999px}.rounded-t-lg{border-top-left-radius:.5rem;border-top-right-radius:.5rem}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-l{border-left-width:1px}.border-l-2{border-left-width:2px}.border-l-4{border-left-width:4px}.border-r{border-right-width:1px}.border-t{border-top-width:1px}.border-double{border-style:double}.border-gray-300{--tw-border-opacity:1;border-color:rgb(209 213 219/var(--tw-border-opacity))}.border-gray-50{--tw-border-opacity:1;border-color:rgb(249 250 251/var(--tw-border-opacity))}.border-indigo-500{--tw-border-opacity:1;border-color:rgb(99 102 241/var(--tw-border-opacity))}.border-slate-100{--tw-border-opacity:1;border-color:rgb(241 245 249/var(--tw-border-opacity))}.border-slate-600{--tw-border-opacity:1;border-color:rgb(71 85 105/var(--tw-border-opacity))}.border-violet-300{--tw-border-opacity:1;border-color:rgb(196 181 253/var(--tw-border-opacity))}.border-white{--tw-border-opacity:1;border-color:rgb(255 255 255/var(--tw-border-opacity))}.border-zinc-500{--tw-border-opacity:1;border-color:rgb(113 113 122/var(--tw-border-opacity))}.border-b-zinc-500{--tw-border-opacity:1;border-bottom-color:rgb(113 113 122/var(--tw-border-opacity))}.bg-black{--tw-bg-opacity:1;background-color:rgb(0 0 0/var(--tw-bg-opacity))}.bg-emerald-600{--tw-bg-opacity:1;background-color:rgb(5 150 105/var(--tw-bg-opacity))}.bg-gray-200{--tw-bg-opacity:1;background-color:rgb(229 231 235/var(--tw-bg-opacity))}.bg-gray-800{--tw-bg-opacity:1;background-color:rgb(31 41 55/var(--tw-bg-opacity))}.bg-red-800{--tw-bg-opacity:1;background-color:rgb(153 27 27/var(--tw-bg-opacity))}.bg-slate-800{--tw-bg-opacity:1;background-color:rgb(30 41 59/var(--tw-bg-opacity))}.bg-slate-900{--tw-bg-opacity:1;background-color:rgb(15 23 42/var(--tw-bg-opacity))}.bg-transparent{background-color:transparent}.bg-violet-500{--tw-bg-opacity:1;background-color:rgb(139 92 246/var(--tw-bg-opacity))}.bg-violet-700{--tw-bg-opacity:1;background-color:rgb(109 40 217/var(--tw-bg-opacity))}.bg-yellow-300{--tw-bg-opacity:1;background-color:rgb(253 224 71/var(--tw-bg-opacity))}.bg-zinc-600{--tw-bg-opacity:1;background-color:rgb(82 82 91/var(--tw-bg-opacity))}.bg-zinc-800{--tw-bg-opacity:1;background-color:rgb(39 39 42/var(--tw-bg-opacity))}.bg-zinc-900{--tw-bg-opacity:1;background-color:rgb(24 24 27/var(--tw-bg-opacity))}.bg-zinc-950{--tw-bg-opacity:1;background-color:rgb(9 9 11/var(--tw-bg-opacity))}.bg-gradient-to-r{background-image:linear-gradient(to right,var(--tw-gradient-stops))}.from-indigo-500{--tw-gradient-from:#6366f1 var(--tw-gradient-from-position);--tw-gradient-to:rgba(99,102,241,0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to)}.from-slate-800{--tw-gradient-from:#1e293b var(--tw-gradient-from-position);--tw-gradient-to:rgba(30,41,59,0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to)}.to-indigo-800{--tw-gradient-to:#3730a3 var(--tw-gradient-to-position)}.to-sky-900{--tw-gradient-to:#0c4a6e var(--tw-gradient-to-position)}.object-cover{-o-object-fit:cover;object-fit:cover}.p-10{padding:2.5rem}.p-20{padding:5rem}.p-3{padding:.75rem}.p-5{padding:1.25rem}.px-10{padding-left:2.5rem;padding-right:2.5rem}.px-16{padding-left:4rem;padding-right:4rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-4{padding-left:1rem;padding-right:1rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.py-0{padding-bottom:0;padding-top:0}.py-0\.5{padding-bottom:.125rem;padding-top:.125rem}.py-1{padding-bottom:.25rem;padding-top:.25rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.py-3{padding-bottom:.75rem;padding-top:.75rem}.py-5{padding-bottom:1.25rem;padding-top:1.25rem}.py-8{padding-bottom:2rem;padding-top:2rem}.pb-10{padding-bottom:2.5rem}.pl-3{padding-left:.75rem}.pl-5{padding-left:1.25rem}.pt-4{padding-top:1rem}.pt-56{padding-top:14rem}.pt-\[76px\]{padding-top:76px}.text-left{text-align:left}.text-center{text-align:center}.align-middle{vertical-align:middle}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-6xl{font-size:3.75rem;line-height:1}.text-\[60px\]{font-size:60px}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.font-bold{font-weight:700}.italic{font-style:italic}.text-gray-100{--tw-text-opacity:1;color:rgb(243 244 246/var(--tw-text-opacity))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175/var(--tw-text-opacity))}.text-gray-50{--tw-text-opacity:1;color:rgb(249 250 251/var(--tw-text-opacity))}.text-indigo-300{--tw-text-opacity:1;color:rgb(165 180 252/var(--tw-text-opacity))}.text-slate-200{--tw-text-opacity:1;color:rgb(226 232 240/var(--tw-text-opacity))}.text-stone-200{--tw-text-opacity:1;color:rgb(231 229 228/var(--tw-text-opacity))}.text-violet-300{--tw-text-opacity:1;color:rgb(196 181 253/var(--tw-text-opacity))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.text-yellow-500{--tw-text-opacity:1;color:rgb(234 179 8/var(--tw-text-opacity))}.text-zinc-800{--tw-text-opacity:1;color:rgb(39 39 42/var(--tw-text-opacity))}.underline{text-decoration-line:underline}.opacity-75{opacity:.75}.shadow-2xl{--tw-shadow:0 25px 50px -12px rgba(0,0,0,.25);--tw-shadow-colored:0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-violet-800{--tw-shadow-color:#5b21b6;--tw-shadow:var(--tw-shadow-colored)}.blur{--tw-blur:blur(8px)}.blur,.drop-shadow{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow{--tw-drop-shadow:drop-shadow(0 1px 2px rgba(0,0,0,.1)) drop-shadow(0 1px 1px rgba(0,0,0,.06))}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur-3xl{--tw-backdrop-blur:blur(64px)}.backdrop-blur-3xl,.backdrop-brightness-110{-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-brightness-110{--tw-backdrop-brightness:brightness(1.1)}.backdrop-saturate-200{--tw-backdrop-saturate:saturate(2);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-all{transition-duration:.15s;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-colors{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}body{background-color:#18181b;color:#f3f4f6}@keyframes grow{0%{width:0}to{width:50%}}body *{z-index:2}html{color-scheme:dark light;scroll-behavior:smooth}.hover\:scale-105:hover{--tw-scale-x:1.05;--tw-scale-y:1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:bg-violet-950:hover{--tw-bg-opacity:1;background-color:rgb(46 16 101/var(--tw-bg-opacity))}.hover\:py-5:hover{padding-bottom:1.25rem;padding-top:1.25rem}.hover\:text-white:hover{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.hover\:underline:hover{text-decoration-line:underline}.hover\:opacity-100:hover{opacity:1}.focus\:py-5:focus{padding-bottom:1.25rem;padding-top:1.25rem}@keyframes spin{to{transform:rotate(1turn)}}.group:hover .group-hover\:animate-spin{animation:spin 1s linear infinite}@media (min-width:1024px){.lg\:col-span-1{grid-column:span 1/span 1}.lg\:col-span-3{grid-column:span 3/span 3}.lg\:block{display:block}.lg\:flex{display:flex}.lg\:w-3\/4{width:75%}.lg\:w-3\/5{width:60%}.lg\:grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.lg\:justify-end{justify-content:flex-end}.lg\:gap-14{gap:3.5rem}}@media (min-width:1280px){.xl\:w-1\/2{width:50%}}</style>
<style>.icon[data-v-53720faf]{display:inline-block;vertical-align:middle}</style>
<style>#article p{font-size:1.125rem;line-height:1.75rem;margin-bottom:1rem;margin-top:1rem}article{font-size:1.25rem}#article hr{border-radius:9999px;margin-bottom:2rem;margin-top:2rem}#article blockquote{border-left-width:4px;margin-bottom:2rem;margin-top:2rem;--tw-border-opacity:1;border-color:rgb(99 102 241/var(--tw-border-opacity));--tw-bg-opacity:1;background-color:rgb(31 41 55/var(--tw-bg-opacity));padding:.75rem 1rem;--tw-text-opacity:1;color:rgb(209 213 219/var(--tw-text-opacity))}#article blockquote>p{font-size:inherit}#article p>code{border-radius:.25rem;--tw-bg-opacity:1;background-color:rgb(82 82 91/var(--tw-bg-opacity));font-style:italic;padding:.125rem .5rem;--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}article li a,article p a{--tw-text-opacity:1;color:rgb(165 180 252/var(--tw-text-opacity));text-decoration-line:underline}article li a:hover,article p a:hover{--tw-text-opacity:1;color:rgb(99 102 241/var(--tw-text-opacity));text-decoration:none}#article :is(h1,h2,h3,h4,h5,h6){font-weight:700;margin-bottom:1.25rem;margin-top:1.25rem}#article :is(h1,h2,h3,h4,h5,h6):before{color:#6366f1;content:"#";font-weight:lighter;margin-bottom:.75rem;margin-right:.75rem;margin-top:.5rem}</style>
<link rel="preload" as="fetch" crossorigin="anonymous" href="/blog/scikit-learn-pipelines/_payload.json?b0922829-a51b-4fa4-a348-73c8ef816773">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/rvfMUhuX.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CMEvC1RZ.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Clxf4WNv.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CKaxSTBj.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BJj9Ufql.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BIYbgugz.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BQkc-AXV.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DPqkQprk.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BejXF4FU.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DBbaR9Of.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CjkMz838.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C-v3KzvZ.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DZ2xa0op.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/D_KStXMB.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/mCaeChTw.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Ds_2GvYS.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Bb6c22hU.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BYjyVXsc.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DAynAz4Z.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/UfIdOB3g.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/6Fai0oiO.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CZk7DnIx.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/u3_J4GHV.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DrQjLW7y.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CkUCxetp.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CPk1NAl9.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BTQ5pcmW.js">
<link rel="prefetch" as="style" href="/_nuxt/useStudio.BLrrQvhe.css">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/BrJT3vwg.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/Dl-1-Uwt.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/Cp3HYb6m.js">
<link rel="icon" type="image/svg" href="/favicon.svg">
<link rel="canonical" href="/blog/scikit-learn-pipelines">
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
<link rel="icon" type="image/svg" href="/favicon.svg">
<meta property="og:title" content="A Comprehensive Guide For scikit-learn Pipelines">
<meta name="twitter:title" content="A Comprehensive Guide For scikit-learn Pipelines">
<meta name="description" content="Going through a step by step guide for building machine learning pipelines for data preprocessing and inference, also covering how preprocess different columns with different transformers, how to add custom transformers, and how to save and load complete pipelines">
<meta property="og:description" content="Going through a step by step guide for building machine learning pipelines for data preprocessing and inference, also covering how preprocess different columns with different transformers, how to add custom transformers, and how to save and load complete pipelines">
<meta name="twitter:description" content="Going through a step by step guide for building machine learning pipelines for data preprocessing and inference, also covering how preprocess different columns with different transformers, how to add custom transformers, and how to save and load complete pipelines">
<meta property="og:url" content="https://mahmoudyusof.github.io/general/scikit-learn-pipelines/">
<meta name="twitter:url" content="https://mahmoudyusof.github.io/general/scikit-learn-pipelines/">
<meta property="og:type" content="article">
<script type="module" src="/_nuxt/rvfMUhuX.js" crossorigin></script>
<script id="unhead:payload" type="application/json">{"titleTemplate":"MJ Blog | %s"}</script>
<meta property="og:site_name" content="nuxt-app"></head><body><div id="__nuxt"><!--[--><nav class="bg-white-500/50 flex fixed top-0 py-2 left-0 w-full backdrop-blur-3xl z-50
        backdrop-brightness-110 backdrop-saturate-200 justify-between px-16 align-middle"><div id="logo" class="flex gap-8 justify-center items-center"><a href="/" class=""><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" width="90" height="60" alt="MJ Logo" data-nuxt-img srcset="/_ipx/s_90x60/logo-white.svg 1x, /_ipx/s_180x120/logo-white.svg 2x" style="height:60px;" src="/_ipx/s_90x60/logo-white.svg"></a></div><div class="flex items-center space-x-3"><a href="/" class="" aria-label="Home"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" style="" width="25px" height="25px" viewBox="0 0 24 24" data-v-53720faf><path fill="currentColor" d="m20 8l-6-5.26a3 3 0 0 0-4 0L4 8a3 3 0 0 0-1 2.26V19a3 3 0 0 0 3 3h12a3 3 0 0 0 3-3v-8.75A3 3 0 0 0 20 8m-6 12h-4v-5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1Zm5-1a1 1 0 0 1-1 1h-2v-5a3 3 0 0 0-3-3h-2a3 3 0 0 0-3 3v5H6a1 1 0 0 1-1-1v-8.75a1 1 0 0 1 .34-.75l6-5.25a1 1 0 0 1 1.32 0l6 5.25a1 1 0 0 1 .34.75Z"/></svg></a><a target="_blank" href="https://twitter.com/mahmoudyusof" aria-label="twitter"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" style="" width="25px" height="25px" viewBox="0 0 512 512" data-v-53720faf><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2L487 464H345L233.7 318.6L106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg></a><a target="_blank" href="https://stackoverflow.com/users/9979796/mahmoud-youssef" aria-label="stackoverflow"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" style="" width="25px" height="25px" viewBox="0 0 384 512" data-v-53720faf><path fill="currentColor" d="M290.7 311L95 269.7L86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8l153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 300zM262 32l-32 24l119.3 160.3l32-24zm20.5 328h-200v39.7h200zm39.7 80H42.7V320h-40v160h359.5V320h-40z"/></svg></a><a target="_blank" href="https://www.linkedin.com/in/mahmoud-yusof-a39ab5151/" aria-label="linkedin"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" style="" width="25px" height="25px" viewBox="0 0 448 512" data-v-53720faf><path fill="currentColor" d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3M447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2c-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3c94 0 111.28 61.9 111.28 142.3V448z"/></svg></a><a target="_blank" href="mailto:mahmoud.yusof27@gmail.com" aria-label="mail"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon" style="" width="25px" height="25px" viewBox="0 0 1792 1408" data-v-53720faf><path fill="currentColor" d="M1664 1248V480q-32 36-69 66q-268 206-426 338q-51 43-83 67t-86.5 48.5T897 1024h-2q-48 0-102.5-24.5T706 951t-83-67Q465 752 197 546q-37-30-69-66v768q0 13 9.5 22.5t22.5 9.5h1472q13 0 22.5-9.5t9.5-22.5m0-1051v-24.5l-.5-13l-3-12.5l-5.5-9l-9-7.5l-14-2.5H160q-13 0-22.5 9.5T128 160q0 168 147 284q193 152 401 317q6 5 35 29.5t46 37.5t44.5 31.5T852 887t43 9h2q20 0 43-9t50.5-27.5T1035 828t46-37.5t35-29.5q208-165 401-317q54-43 100.5-115.5T1664 197m128-37v1088q0 66-47 113t-113 47H160q-66 0-113-47T0 1248V160Q0 94 47 47T160 0h1472q66 0 113 47t47 113"/></svg></a></div></nav><div class="pt-[76px]"><!--[--><div id="article" class="border-gray-50 border-t border-b bg-zinc-950 grid grid-cols-5"><div title="A Comprehensive Guide For scikit-learn Pipelines" fullpath="/blog/scikit-learn-pipelines"></div><article class="p-10 lg:col-span-3 col-span-5"><div><h1 id="a-comprehensive-guide-for-scikit-learn-pipelines"><!--[-->A Comprehensive Guide For scikit-learn Pipelines<!--]--></h1><p><!--[-->Scikit Learn has a very easy and useful architecture for building complete pipelines for machine learning. In this article, we&#39;ll go through a step by step example on how to used the different features and classes of this architecture.<!--]--></p><hr><h2 id="why"><a href="#why"><!--[-->Why?<!--]--></a></h2><p><!--[-->There are plenty of reasons why you might want to use a pipeline for machine learning like:<!--]--></p><ul><!--[--><li><!--[-->Combine the preprocessing step with the inference step at one object.<!--]--></li><li><!--[-->Save the complete pipeline to disk.<!--]--></li><li><!--[-->Easily experiment with different techniques of preprocessing.<!--]--></li><li><!--[-->Pipeline reuse.<!--]--></li><li><!--[-->Easy cloud deployment.<!--]--></li><!--]--></ul><hr><h2 id="how"><a href="#how"><!--[-->How?<!--]--></a></h2><p><!--[-->Alright, now let&#39;s get down to business. In this article we&#39;ll use a fairly easy and old problem as an example, which is the <a href="https://www.kaggle.com/c/home-data-for-ml-course" rel="noopener noreferrer" class="mdlink"><!--[-->Regression problem for predicting housing prices<!--]--></a>.<br>
Download the data and you should have a <code class=""><!--[-->train.csv<!--]--></code> file and a <code class=""><!--[-->test.csv<!--]--></code> file, we&#39;ll load both using pandas.<!--]--></p><hr><h3 id="loading-the-data"><a href="#loading-the-data"><!--[-->Loading the data<!--]--></a></h3><div class="bg-zinc-900 border border-zinc-500 my-2" style=""><!----><pre class="p-5 language-python shiki shiki-themes dark-plus github-dark text-wrap"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">import</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> pandas </span><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">as</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> pd
</span></span><span class="line" line="2"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">import</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> numpy </span><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">as</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> np
</span></span><span class="line" line="3"><span emptylineplaceholder="true">
</span></span><span class="line" line="4"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">train_df </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> pd.read_csv(</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;train.csv&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">)
</span></span><span class="line" line="5"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">test_df </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> pd.read_csv(</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;test.csv&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">)
</span></span><span class="line" line="6"><span emptylineplaceholder="true">
</span></span><span class="line" line="7"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">## let&#39;s create a validation set from the training set
</span></span><span class="line" line="8"><span emptylineplaceholder="true">
</span></span><span class="line" line="9"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">msk </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> np.random.rand(</span><span style="--shiki-default:#DCDCAA;--shiki-dark:#79B8FF">len</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(train_df)) </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">&lt;</span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"> 0.8
</span></span><span class="line" line="10"><span emptylineplaceholder="true">
</span></span><span class="line" line="11"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">val_df </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> train_df[</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">~</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">msk]
</span></span><span class="line" line="12"><span emptylineplaceholder="true">
</span></span><span class="line" line="13"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">train_df </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> train_df[msk]
</span></span></code><!--]--></pre></div><hr><h3 id="feature-selection"><a href="#feature-selection"><!--[-->Feature selection<!--]--></a></h3><p><!--[-->This data has 163 columns, however, we are not going to use all of them.<br>
After doing a bit of EDA we choose a set of nominal, ordinal and numerical columns to work with.<!--]--></p><div class="bg-zinc-900 border border-zinc-500 my-2" style=""><!----><pre class="p-5 language-python shiki shiki-themes dark-plus github-dark text-wrap"><!--[--><code><span class="line" line="1"><span emptylineplaceholder="true">
</span></span><span class="line" line="2"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">nominal </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> [</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;MSZoning&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;LotShape&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;LandContour&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;LotConfig&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;Neighborhood&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">,
</span></span><span class="line" line="3"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">           &quot;Condition1&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;BldgType&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;RoofStyle&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">,
</span></span><span class="line" line="4"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">           &quot;Foundation&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;CentralAir&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;SaleType&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;SaleCondition&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">]
</span></span><span class="line" line="5"><span emptylineplaceholder="true">
</span></span><span class="line" line="6"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">ordinal </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> [</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;LandSlope&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;OverallQual&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;OverallCond&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;YearRemodAdd&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">,
</span></span><span class="line" line="7"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">          &quot;ExterQual&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;ExterCond&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;BsmtQual&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;BsmtCond&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;BsmtExposure&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">,
</span></span><span class="line" line="8"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">          &quot;KitchenQual&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;Functional&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;GarageCond&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;PavedDrive&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">]
</span></span><span class="line" line="9"><span emptylineplaceholder="true">
</span></span><span class="line" line="10"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">numerical </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> [</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;LotFrontage&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;LotArea&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;MasVnrArea&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;BsmtFinSF1&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;BsmtUnfSF&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">,
</span></span><span class="line" line="11"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">            &quot;TotalBsmtSF&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;1stFlrSF&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;2ndFlrSF&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;GrLivArea&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;GarageArea&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">,
</span></span><span class="line" line="12"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">            &quot;OpenPorchSF&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">]
</span></span><span class="line" line="13"><span emptylineplaceholder="true">
</span></span><span class="line" line="14"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">train_features </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> train_df[nominal </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">+</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> ordinal </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">+</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> numerical]
</span></span><span class="line" line="15"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">train_label </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> train_df[</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;SalePrice&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">]
</span></span><span class="line" line="16"><span emptylineplaceholder="true">
</span></span><span class="line" line="17"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">val_features </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> val_df[nominal </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">+</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> ordinal </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">+</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> numerical]
</span></span><span class="line" line="18"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">val_label </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> val_df[</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;SalePrice&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">]
</span></span><span class="line" line="19"><span emptylineplaceholder="true">
</span></span><span class="line" line="20"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">test_features </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> test_df[nominal </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">+</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> ordinal </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">+</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> numerical]
</span></span></code><!--]--></pre></div><p><!--[-->If you want to see the entire selection process and EDA fully explained, you can see the notebook <a href="https://www.kaggle.com/mahmoud1youssef/housing-prices-full-solution" rel="noopener noreferrer" class="mdlink"><!--[-->here<!--]--></a><!--]--></p><hr><h3 id="preprocessing"><a href="#preprocessing"><!--[-->Preprocessing<!--]--></a></h3><p><!--[-->Now let&#39;s choose a preprocessing plan, a very straight forward one is the following:<!--]--></p><ul><!--[--><li><!--[-->Ordinal features
<ul><!--[--><li><!--[-->Impute missing data with most frequent value<!--]--></li><li><!--[-->Use Ordinal Encoding<!--]--></li><!--]--></ul><!--]--></li><li><!--[-->Nominal Features
<ul><!--[--><li><!--[-->Impute missing data with most frequent value<!--]--></li><li><!--[-->Use One Hot Encoding<!--]--></li><!--]--></ul><!--]--></li><li><!--[-->Numerical Features
<ul><!--[--><li><!--[-->Impute missing data with mean value<!--]--></li><li><!--[-->Use Standard Scaling<!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><p><!--[-->As you may see, each family of features has its own unique way of getting processed. Let&#39;s create a Pipeline for each family.<br>
We can do so by using the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html" rel="noopener noreferrer" class="mdlink"><!--[-->sklearn.pipeline.Pipeline<!--]--></a> Object<!--]--></p><div class="bg-zinc-900 border border-zinc-500 my-2" style=""><!----><pre class="p-5 language-python shiki shiki-themes dark-plus github-dark text-wrap"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">from</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> sklearn.pipeline </span><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">import</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> Pipeline
</span></span><span class="line" line="2"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">from</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> sklearn.impute </span><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">import</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> SimpleImputer
</span></span><span class="line" line="3"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">from</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> sklearn.preprocessing </span><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">import</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> StandardScaler, OrdinalEncoder, OneHotEncoder
</span></span><span class="line" line="4"><span emptylineplaceholder="true">
</span></span><span class="line" line="5"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">ordinal_pipeline </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> Pipeline([
</span></span><span class="line" line="6"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;imputer&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, SimpleImputer(</span><span style="--shiki-default:#9CDCFE;--shiki-dark:#FFAB70">strategy</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;most_frequent&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">)),
</span></span><span class="line" line="7"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;encoder&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, OrdinalEncoder())
</span></span><span class="line" line="8"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">])
</span></span><span class="line" line="9"><span emptylineplaceholder="true">
</span></span><span class="line" line="10"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">nominal_pipeline </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> Pipeline([
</span></span><span class="line" line="11"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;imputer&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, SimpleImputer(</span><span style="--shiki-default:#9CDCFE;--shiki-dark:#FFAB70">strategy</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;most_frequent&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">)),
</span></span><span class="line" line="12"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;encoder&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, OneHotEncoder(</span><span style="--shiki-default:#9CDCFE;--shiki-dark:#FFAB70">sparse</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">True</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#9CDCFE;--shiki-dark:#FFAB70">handle_unknown</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;ignore&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">))
</span></span><span class="line" line="13"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">])
</span></span><span class="line" line="14"><span emptylineplaceholder="true">
</span></span><span class="line" line="15"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">numerical_pipeline </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> Pipeline([
</span></span><span class="line" line="16"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;imputer&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, SimpleImputer(</span><span style="--shiki-default:#9CDCFE;--shiki-dark:#FFAB70">strategy</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;mean&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">)),
</span></span><span class="line" line="17"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;scaler&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, StandardScaler())
</span></span><span class="line" line="18"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">])
</span></span></code><!--]--></pre></div><p><!--[-->Now let&#39;s join all of the above in one pipeline that targets each column with its family&#39;s pipeline.<br>
We can do so using the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.compose.ColumnTransformer.html?highlight=columntransformer#sklearn.compose.ColumnTransformer" rel="noopener noreferrer" class="mdlink"><!--[-->sklearn.compose.ColumnTransformer<!--]--></a> Object<!--]--></p><div class="bg-zinc-900 border border-zinc-500 my-2" style=""><!----><pre class="p-5 language-python shiki shiki-themes dark-plus github-dark text-wrap"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">from</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> sklearn.compose </span><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">import</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> ColumnTransformer
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D"># here we are going to instantiate a ColumnTransformer object with a list of tuples
</span></span><span class="line" line="4"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D"># each of which has a the name of the preprocessor
</span></span><span class="line" line="5"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D"># the transformation pipeline (could be a transformer)
</span></span><span class="line" line="6"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D"># and the list of column names we wish to transform
</span></span><span class="line" line="7"><span emptylineplaceholder="true">
</span></span><span class="line" line="8"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">preprocessing_pipeline </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> ColumnTransformer([
</span></span><span class="line" line="9"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;nominal_preprocessor&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, nominal_pipeline, nominal),
</span></span><span class="line" line="10"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;ordinal_preprocessor&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, ordinal_pipeline, ordinal),
</span></span><span class="line" line="11"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;numerical_preprocessor&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, numerical_pipeline, numerical)
</span></span><span class="line" line="12"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">])
</span></span><span class="line" line="13"><span emptylineplaceholder="true">
</span></span><span class="line" line="14"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">## If you want to test this pipeline run the following code
</span></span><span class="line" line="15"><span emptylineplaceholder="true">
</span></span><span class="line" line="16"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D"># preprocessed_features = preprocessing_pipeline.fit_transform(train_features)
</span></span></code><!--]--></pre></div><hr><h3 id="adding-the-model-to-the-pipeline"><a href="#adding-the-model-to-the-pipeline"><!--[-->Adding the model to the pipeline<!--]--></a></h3><p><!--[-->Now that we&#39;re done creating the preprocessing pipeline let&#39;s add the model to the end.<!--]--></p><div class="bg-zinc-900 border border-zinc-500 my-2" style=""><!----><pre class="p-5 language-python shiki shiki-themes dark-plus github-dark text-wrap"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">from</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> sklearn.linear_model </span><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">import</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> LinearRegression
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">complete_pipeline </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> Pipeline([
</span></span><span class="line" line="4"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;preprocessor&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, preprocessing_pipeline),
</span></span><span class="line" line="5"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;estimator&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, LinearRegression())
</span></span><span class="line" line="6"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">])
</span></span></code><!--]--></pre></div><p><!--[-->If you&#39;re waiting for the rest of the code, I&#39;d like to tell you that that&#39;s it. Pretty easy isn&#39;t it. If the scikit-learn maintainers ask to take my heart I&#39;d give it to them for such great API.<br>
The training and evaluation process is the same as any normal model<!--]--></p><div class="bg-zinc-900 border border-zinc-500 my-2" style=""><!----><pre class="p-5 language-python shiki shiki-themes dark-plus github-dark text-wrap"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">complete_pipeline.fit(train_features, train_label)
</span></span><span class="line" line="2"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">score </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> complete_pipeline.score(val_features, val_label)
</span></span><span class="line" line="3"><span emptylineplaceholder="true">
</span></span><span class="line" line="4"><span style="--shiki-default:#DCDCAA;--shiki-dark:#79B8FF">print</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(score)
</span></span><span class="line" line="5"><span emptylineplaceholder="true">
</span></span><span class="line" line="6"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">predictions </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> complete_pipeline.predict(test_features)
</span></span></code><!--]--></pre></div><hr><h2 id="saving-and-loading-pipelines"><a href="#saving-and-loading-pipelines"><!--[-->Saving and Loading Pipelines<!--]--></a></h2><p><!--[-->Now we want to save the entire preprocessing parameters and model parameters of this pipeline to disk and load it whenever needed.<br>
We are going to use <a href="https://joblib.readthedocs.io/en/latest/" rel="noopener noreferrer" class="mdlink"><!--[-->joblib<!--]--></a> for this <strong><!--[-->JOB<!--]--></strong> ... get it? ... sorry.<!--]--></p><h3 id="save-the-pipeline"><a href="#save-the-pipeline"><!--[-->Save the pipeline<!--]--></a></h3><p><!--[-->We are going to save the model as a pickle (.pkl) file. The code is fairly simple.<!--]--></p><div class="bg-zinc-900 border border-zinc-500 my-2" style=""><!----><pre class="p-5 language-python shiki shiki-themes dark-plus github-dark text-wrap"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">import</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> joblib
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">pipeline_filename </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF"> &quot;my_pipeline.pkl&quot;
</span></span><span class="line" line="4"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">joblib.dump(complete_pipeline, pipeline_filename)
</span></span></code><!--]--></pre></div><hr><h3 id="load-the-pipeline"><a href="#load-the-pipeline"><!--[-->Load the pipeline<!--]--></a></h3><p><!--[-->Now you&#39;re on your flask server and you wish to load the model to help a user predict the price of a house, so you want to load the model from disk when you start the server, or whenever a request is sent. That is also fairly simple.<!--]--></p><div class="bg-zinc-900 border border-zinc-500 my-2" style=""><!----><pre class="p-5 language-python shiki shiki-themes dark-plus github-dark text-wrap"><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">import</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> joblib
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">pipeline_filename </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF"> &quot;path/to/pipeline/file.pkl&quot;
</span></span><span class="line" line="4"><span emptylineplaceholder="true">
</span></span><span class="line" line="5"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">pipeline </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> joblib.load(pipeline_filename)
</span></span><span class="line" line="6"><span emptylineplaceholder="true">
</span></span><span class="line" line="7"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">## do inference with pipeline.predict
</span></span><span class="line" line="8"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D"># ...
</span></span></code><!--]--></pre></div><hr><h2 id="full-code"><a href="#full-code"><!--[-->Full Code<!--]--></a></h2><div class="bg-zinc-900 border border-zinc-500 my-2" style=""><!----><pre class="p-5 language-python shiki shiki-themes dark-plus github-dark text-wrap"><!--[--><code><span class="line" line="1"><span emptylineplaceholder="true">
</span></span><span class="line" line="2"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">import</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> pandas </span><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">as</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> pd
</span></span><span class="line" line="3"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">import</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> numpy </span><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">as</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> np
</span></span><span class="line" line="4"><span emptylineplaceholder="true">
</span></span><span class="line" line="5"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">train_df </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> pd.read_csv(</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;train.csv&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">)
</span></span><span class="line" line="6"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">test_df </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> pd.read_csv(</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;test.csv&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">)
</span></span><span class="line" line="7"><span emptylineplaceholder="true">
</span></span><span class="line" line="8"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">## let&#39;s create a validation set from the training set
</span></span><span class="line" line="9"><span emptylineplaceholder="true">
</span></span><span class="line" line="10"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">msk </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> np.random.rand(</span><span style="--shiki-default:#DCDCAA;--shiki-dark:#79B8FF">len</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(train_df)) </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">&lt;</span><span style="--shiki-default:#B5CEA8;--shiki-dark:#79B8FF"> 0.8
</span></span><span class="line" line="11"><span emptylineplaceholder="true">
</span></span><span class="line" line="12"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">val_df </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> train_df[</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">~</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">msk]
</span></span><span class="line" line="13"><span emptylineplaceholder="true">
</span></span><span class="line" line="14"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">train_df </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> train_df[msk]
</span></span><span class="line" line="15"><span emptylineplaceholder="true">
</span></span><span class="line" line="16"><span emptylineplaceholder="true">
</span></span><span class="line" line="17"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">nominal </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> [</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;MSZoning&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;LotShape&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;LandContour&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;LotConfig&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;Neighborhood&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">,
</span></span><span class="line" line="18"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">           &quot;Condition1&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;BldgType&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;RoofStyle&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">,
</span></span><span class="line" line="19"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">           &quot;Foundation&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;CentralAir&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;SaleType&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;SaleCondition&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">]
</span></span><span class="line" line="20"><span emptylineplaceholder="true">
</span></span><span class="line" line="21"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">ordinal </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> [</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;LandSlope&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;OverallQual&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;OverallCond&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;YearRemodAdd&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">,
</span></span><span class="line" line="22"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">          &quot;ExterQual&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;ExterCond&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;BsmtQual&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;BsmtCond&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;BsmtExposure&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">,
</span></span><span class="line" line="23"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">          &quot;KitchenQual&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;Functional&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;GarageCond&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;PavedDrive&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">]
</span></span><span class="line" line="24"><span emptylineplaceholder="true">
</span></span><span class="line" line="25"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">numerical </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> [</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;LotFrontage&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;LotArea&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;MasVnrArea&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;BsmtFinSF1&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;BsmtUnfSF&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">,
</span></span><span class="line" line="26"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">            &quot;TotalBsmtSF&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;1stFlrSF&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;2ndFlrSF&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;GrLivArea&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;GarageArea&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">,
</span></span><span class="line" line="27"><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">            &quot;OpenPorchSF&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">]
</span></span><span class="line" line="28"><span emptylineplaceholder="true">
</span></span><span class="line" line="29"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">train_features </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> train_df[nominal </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">+</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> ordinal </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">+</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> numerical]
</span></span><span class="line" line="30"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">train_label </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> train_df[</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;SalePrice&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">]
</span></span><span class="line" line="31"><span emptylineplaceholder="true">
</span></span><span class="line" line="32"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">val_features </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> val_df[nominal </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">+</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> ordinal </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">+</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> numerical]
</span></span><span class="line" line="33"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">val_label </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> val_df[</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;SalePrice&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">]
</span></span><span class="line" line="34"><span emptylineplaceholder="true">
</span></span><span class="line" line="35"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">test_features </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> test_df[nominal </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">+</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> ordinal </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">+</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> numerical]
</span></span><span class="line" line="36"><span emptylineplaceholder="true">
</span></span><span class="line" line="37"><span emptylineplaceholder="true">
</span></span><span class="line" line="38"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">from</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> sklearn.pipeline </span><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">import</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> Pipeline
</span></span><span class="line" line="39"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">from</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> sklearn.impute </span><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">import</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> SimpleImputer
</span></span><span class="line" line="40"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">from</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> sklearn.preprocessing </span><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">import</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> StandardScaler, OrdinalEncoder, OneHotEncoder
</span></span><span class="line" line="41"><span emptylineplaceholder="true">
</span></span><span class="line" line="42"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">ordinal_pipeline </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> Pipeline([
</span></span><span class="line" line="43"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;imputer&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, SimpleImputer(</span><span style="--shiki-default:#9CDCFE;--shiki-dark:#FFAB70">strategy</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;most_frequent&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">)),
</span></span><span class="line" line="44"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;encoder&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, OrdinalEncoder())
</span></span><span class="line" line="45"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">])
</span></span><span class="line" line="46"><span emptylineplaceholder="true">
</span></span><span class="line" line="47"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">nominal_pipeline </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> Pipeline([
</span></span><span class="line" line="48"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;imputer&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, SimpleImputer(</span><span style="--shiki-default:#9CDCFE;--shiki-dark:#FFAB70">strategy</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;most_frequent&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">)),
</span></span><span class="line" line="49"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;encoder&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, OneHotEncoder(</span><span style="--shiki-default:#9CDCFE;--shiki-dark:#FFAB70">sparse</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#569CD6;--shiki-dark:#79B8FF">True</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#9CDCFE;--shiki-dark:#FFAB70">handle_unknown</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;ignore&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">))
</span></span><span class="line" line="50"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">])
</span></span><span class="line" line="51"><span emptylineplaceholder="true">
</span></span><span class="line" line="52"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">numerical_pipeline </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> Pipeline([
</span></span><span class="line" line="53"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;imputer&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, SimpleImputer(</span><span style="--shiki-default:#9CDCFE;--shiki-dark:#FFAB70">strategy</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;mean&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">)),
</span></span><span class="line" line="54"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;scaler&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, StandardScaler())
</span></span><span class="line" line="55"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">])
</span></span><span class="line" line="56"><span emptylineplaceholder="true">
</span></span><span class="line" line="57"><span emptylineplaceholder="true">
</span></span><span class="line" line="58"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">from</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> sklearn.compose </span><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">import</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> ColumnTransformer
</span></span><span class="line" line="59"><span emptylineplaceholder="true">
</span></span><span class="line" line="60"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D"># here we are going to instantiate a ColumnTransformer object with a list of tuples
</span></span><span class="line" line="61"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D"># each of which has a the name of the preprocessor
</span></span><span class="line" line="62"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D"># the transformation pipeline (could be a transformer)
</span></span><span class="line" line="63"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D"># and the list of column names we wish to transform
</span></span><span class="line" line="64"><span emptylineplaceholder="true">
</span></span><span class="line" line="65"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">preprocessing_pipeline </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> ColumnTransformer([
</span></span><span class="line" line="66"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;nominal_preprocessor&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, nominal_pipeline, nominal),
</span></span><span class="line" line="67"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;ordinal_preprocessor&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, ordinal_pipeline, ordinal),
</span></span><span class="line" line="68"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;numerical_preprocessor&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, numerical_pipeline, numerical)
</span></span><span class="line" line="69"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">])
</span></span><span class="line" line="70"><span emptylineplaceholder="true">
</span></span><span class="line" line="71"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D">## If you want to test this pipeline run the following code
</span></span><span class="line" line="72"><span emptylineplaceholder="true">
</span></span><span class="line" line="73"><span style="--shiki-default:#6A9955;--shiki-dark:#6A737D"># preprocessed_features = preprocessing_pipeline.fit_transform(train_features)
</span></span><span class="line" line="74"><span emptylineplaceholder="true">
</span></span><span class="line" line="75"><span emptylineplaceholder="true">
</span></span><span class="line" line="76"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">from</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> sklearn.linear_model </span><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">import</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> LinearRegression
</span></span><span class="line" line="77"><span emptylineplaceholder="true">
</span></span><span class="line" line="78"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">complete_pipeline </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> Pipeline([
</span></span><span class="line" line="79"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;preprocessor&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, preprocessing_pipeline),
</span></span><span class="line" line="80"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">    (</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF">&quot;estimator&quot;</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">, LinearRegression())
</span></span><span class="line" line="81"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">])
</span></span><span class="line" line="82"><span emptylineplaceholder="true">
</span></span><span class="line" line="83"><span emptylineplaceholder="true">
</span></span><span class="line" line="84"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">complete_pipeline.fit(train_features, train_label)
</span></span><span class="line" line="85"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">score </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> complete_pipeline.score(val_features, val_label)
</span></span><span class="line" line="86"><span emptylineplaceholder="true">
</span></span><span class="line" line="87"><span style="--shiki-default:#DCDCAA;--shiki-dark:#79B8FF">print</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(score)
</span></span><span class="line" line="88"><span emptylineplaceholder="true">
</span></span><span class="line" line="89"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">predictions </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> complete_pipeline.predict(test_features)
</span></span><span class="line" line="90"><span emptylineplaceholder="true">
</span></span><span class="line" line="91"><span emptylineplaceholder="true">
</span></span><span class="line" line="92"><span style="--shiki-default:#C586C0;--shiki-dark:#F97583">import</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> joblib
</span></span><span class="line" line="93"><span emptylineplaceholder="true">
</span></span><span class="line" line="94"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">pipeline_filename </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#CE9178;--shiki-dark:#9ECBFF"> &quot;my_pipeline.pkl&quot;
</span></span><span class="line" line="95"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">joblib.dump(complete_pipeline, pipeline_filename)
</span></span><span class="line" line="96"><span emptylineplaceholder="true">
</span></span><span class="line" line="97"><span emptylineplaceholder="true">
</span></span><span class="line" line="98"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">pipeline </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> joblib.load(pipeline_filename)
</span></span><span class="line" line="99"><span emptylineplaceholder="true">
</span></span><span class="line" line="100"><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">predictions </span><span style="--shiki-default:#D4D4D4;--shiki-dark:#F97583">=</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8"> pipeline.predict(test_df)
</span></span><span class="line" line="101"><span style="--shiki-default:#DCDCAA;--shiki-dark:#79B8FF">print</span><span style="--shiki-default:#D4D4D4;--shiki-dark:#E1E4E8">(predictions)
</span></span></code><!--]--></pre></div><hr><p><!--[-->That&#39;s it, Congratulations, you&#39;ve just created, saved and loaded your complete pipeline.<br>
I hope this article was helpful, if not, please tell me how to improve it, I would really appreciate that.
Thank you.<!--]--></p><hr><p><!--[--><a href="https://www.oreilly.com/library/view/hands-on-machine-learning/9781492032632/" rel="noopener noreferrer" class="mdlink"><!--[-->Reference Book<!--]--></a><!--]--></p><p><!--[--><a href="https://www.kaggle.com/mahmoud1youssef/housing-prices-full-solution" rel="noopener noreferrer" class="mdlink"><!--[-->My Notebook<!--]--></a><!--]--></p><style>html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}</style></div></article><div class="border-l border-double border-gray-300 pt-4 lg:col-span-1 lg:block hidden"><span class="sticky top-28"><ul style="list-style-type:none;"><!--[--><li><a aria-current="page" href="/blog/scikit-learn-pipelines#why" class="text-white router-link-exact-active hover:underline text-slate-200 hover:text-white"># Why?</a><!----></li><li><a aria-current="page" href="/blog/scikit-learn-pipelines#how" class="text-white router-link-exact-active hover:underline text-slate-200 hover:text-white"># How?</a><ul style="list-style-type:none;"><!--[--><li><a aria-current="page" href="/blog/scikit-learn-pipelines#loading-the-data" class="text-white router-link-exact-active hover:underline text-slate-200 hover:text-white"># Loading the data</a><!----></li><li><a aria-current="page" href="/blog/scikit-learn-pipelines#feature-selection" class="text-white router-link-exact-active hover:underline text-slate-200 hover:text-white"># Feature selection</a><!----></li><li><a aria-current="page" href="/blog/scikit-learn-pipelines#preprocessing" class="text-white router-link-exact-active hover:underline text-slate-200 hover:text-white"># Preprocessing</a><!----></li><li><a aria-current="page" href="/blog/scikit-learn-pipelines#adding-the-model-to-the-pipeline" class="text-white router-link-exact-active hover:underline text-slate-200 hover:text-white"># Adding the model to the pipeline</a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/blog/scikit-learn-pipelines#saving-and-loading-pipelines" class="text-white router-link-exact-active hover:underline text-slate-200 hover:text-white"># Saving and Loading Pipelines</a><ul style="list-style-type:none;"><!--[--><li><a aria-current="page" href="/blog/scikit-learn-pipelines#save-the-pipeline" class="text-white router-link-exact-active hover:underline text-slate-200 hover:text-white"># Save the pipeline</a><!----></li><li><a aria-current="page" href="/blog/scikit-learn-pipelines#load-the-pipeline" class="text-white router-link-exact-active hover:underline text-slate-200 hover:text-white"># Load the pipeline</a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/blog/scikit-learn-pipelines#full-code" class="text-white router-link-exact-active hover:underline text-slate-200 hover:text-white"># Full Code</a><!----></li><!--]--></ul></span></div></div><!--]--></div><footer class="bg-black py-8 gap-4 text-white flex flex-col justify-center items-center"><p class=""> 2024 Designed and Created by ... well, you can guess</p><div class="space-x-2"><a class="text-gray-400 hover:text-white transition-colors" aria-label="Twitter @mahmoudyusof" target="_blank" href="https://twitter.com/mahmoudyusof"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon mr-2" style="" width="25px" height="25px" viewBox="0 0 512 512" data-v-53720faf><path fill="currentColor" d="M389.2 48h70.6L305.6 224.2L487 464H345L233.7 318.6L106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z"/></svg></a><a class="text-gray-400 hover:text-white transition-colors" aria-label="Stackoverflow 9979796/mahmoud-youssef" target="_blank" href="https://stackoverflow.com/users/9979796/mahmoud-youssef"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon mr-2" style="" width="25px" height="25px" viewBox="0 0 24 24" data-v-53720faf><path fill="currentColor" d="M17.36 20.2v-5.38h1.79V22H3v-7.18h1.8v5.38zM6.77 14.32l.37-1.76l8.79 1.85l-.37 1.76zm1.16-4.21l.76-1.61l8.14 3.78l-.76 1.62zm2.26-3.99l1.15-1.38l6.9 5.76l-1.15 1.37zm4.45-4.25L20 9.08l-1.44 1.07l-5.36-7.21zM6.59 18.41v-1.8h8.98v1.8z"/></svg></a><a class="text-gray-400 hover:text-white transition-colors" aria-label="Linkedin mahmoud-yusof-a39ab5151" target="_blank" href="https://www.linkedin.com/in/mahmoud-yusof-a39ab5151/"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon mr-2" style="" width="25px" height="25px" viewBox="0 0 448 512" data-v-53720faf><path fill="currentColor" d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3M447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2c-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3c94 0 111.28 61.9 111.28 142.3V448z"/></svg></a><a class="text-gray-400 hover:text-white transition-colors" aria-label="email mahmoud.yusof27@gmail.com" href="mailto:mahmoud.yusof27@gmail.com"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="icon mr-2" style="" width="25px" height="25px" viewBox="0 0 1792 1408" data-v-53720faf><path fill="currentColor" d="M1664 1248V480q-32 36-69 66q-268 206-426 338q-51 43-83 67t-86.5 48.5T897 1024h-2q-48 0-102.5-24.5T706 951t-83-67Q465 752 197 546q-37-30-69-66v768q0 13 9.5 22.5t22.5 9.5h1472q13 0 22.5-9.5t9.5-22.5m0-1051v-24.5l-.5-13l-3-12.5l-5.5-9l-9-7.5l-14-2.5H160q-13 0-22.5 9.5T128 160q0 168 147 284q193 152 401 317q6 5 35 29.5t46 37.5t44.5 31.5T852 887t43 9h2q20 0 43-9t50.5-27.5T1035 828t46-37.5t35-29.5q208-165 401-317q54-43 100.5-115.5T1664 197m128-37v1088q0 66-47 113t-113 47H160q-66 0-113-47T0 1248V160Q0 94 47 47T160 0h1472q66 0 113 47t47 113"/></svg></a></div></footer><!--]--></div><div id="teleports"></div><script id="nuxt-og-image-options" type="application/json">{"component":"OgImageBlogPost","props":{"logo":"/logo-white.svg","title":"A Comprehensive Guide For scikit-learn Pipelines"},"_query":{}}</script>
<script type="application/json" id="__NUXT_DATA__" data-ssr="true" data-src="/blog/scikit-learn-pipelines/_payload.json?b0922829-a51b-4fa4-a348-73c8ef816773">[{"state":1,"once":27,"_errors":28,"serverRendered":31,"path":32,"prerenderedAt":33},["Reactive",2],{"$sicons":3,"$ssite-config":24},{"uil:home-alt":4,"fa6-brands:x-twitter":9,"fa6-brands:stack-overflow":12,"fa6-brands:linkedin-in":15,"fa:envelope-o":18,"mdi:stack-overflow":22},{"left":5,"top":5,"width":6,"height":6,"rotate":5,"vFlip":7,"hFlip":7,"body":8},0,24,false,"\u003Cpath fill=\"currentColor\" d=\"m20 8l-6-5.26a3 3 0 0 0-4 0L4 8a3 3 0 0 0-1 2.26V19a3 3 0 0 0 3 3h12a3 3 0 0 0 3-3v-8.75A3 3 0 0 0 20 8m-6 12h-4v-5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1Zm5-1a1 1 0 0 1-1 1h-2v-5a3 3 0 0 0-3-3h-2a3 3 0 0 0-3 3v5H6a1 1 0 0 1-1-1v-8.75a1 1 0 0 1 .34-.75l6-5.25a1 1 0 0 1 1.32 0l6 5.25a1 1 0 0 1 .34.75Z\"/>",{"left":5,"top":5,"width":10,"height":10,"rotate":5,"vFlip":7,"hFlip":7,"body":11},512,"\u003Cpath fill=\"currentColor\" d=\"M389.2 48h70.6L305.6 224.2L487 464H345L233.7 318.6L106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9zm-24.8 373.8h39.1L151.1 88h-42z\"/>",{"left":5,"top":5,"width":13,"height":10,"rotate":5,"vFlip":7,"hFlip":7,"body":14},384,"\u003Cpath fill=\"currentColor\" d=\"M290.7 311L95 269.7L86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8l153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 300zM262 32l-32 24l119.3 160.3l32-24zm20.5 328h-200v39.7h200zm39.7 80H42.7V320h-40v160h359.5V320h-40z\"/>",{"left":5,"top":5,"width":16,"height":10,"rotate":5,"vFlip":7,"hFlip":7,"body":17},448,"\u003Cpath fill=\"currentColor\" d=\"M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3M447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2c-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3c94 0 111.28 61.9 111.28 142.3V448z\"/>",{"left":5,"top":5,"width":19,"height":20,"rotate":5,"vFlip":7,"hFlip":7,"body":21},1792,1408,"\u003Cpath fill=\"currentColor\" d=\"M1664 1248V480q-32 36-69 66q-268 206-426 338q-51 43-83 67t-86.5 48.5T897 1024h-2q-48 0-102.5-24.5T706 951t-83-67Q465 752 197 546q-37-30-69-66v768q0 13 9.5 22.5t22.5 9.5h1472q13 0 22.5-9.5t9.5-22.5m0-1051v-24.5l-.5-13l-3-12.5l-5.5-9l-9-7.5l-14-2.5H160q-13 0-22.5 9.5T128 160q0 168 147 284q193 152 401 317q6 5 35 29.5t46 37.5t44.5 31.5T852 887t43 9h2q20 0 43-9t50.5-27.5T1035 828t46-37.5t35-29.5q208-165 401-317q54-43 100.5-115.5T1664 197m128-37v1088q0 66-47 113t-113 47H160q-66 0-113-47T0 1248V160Q0 94 47 47T160 0h1472q66 0 113 47t47 113\"/>",{"left":5,"top":5,"width":6,"height":6,"rotate":5,"vFlip":7,"hFlip":7,"body":23},"\u003Cpath fill=\"currentColor\" d=\"M17.36 20.2v-5.38h1.79V22H3v-7.18h1.8v5.38zM6.77 14.32l.37-1.76l8.79 1.85l-.37 1.76zm1.16-4.21l.76-1.61l8.14 3.78l-.76 1.62zm2.26-3.99l1.15-1.38l6.9 5.76l-1.15 1.37zm4.45-4.25L20 9.08l-1.44 1.07l-5.36-7.21zM6.59 18.41v-1.8h8.98v1.8z\"/>",{"env":25,"name":26},"production","nuxt-app",["Set"],["ShallowReactive",29],{"my-page":30},null,true,"/blog/scikit-learn-pipelines",1718310152926]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{mdc:{components:{prose:true,map:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"}},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}}},content:{locales:[],defaultLocale:"",integrity:1718310114290,experimental:{stripQueryParameters:false,advanceQuery:false,clientDB:false},respectPathCase:false,api:{baseURL:"/api/_content"},navigation:{fields:["date"]},tags:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},highlight:{langs:["javascript","python","shell","typescript","json","yaml","css","html","markdown","bash","dockerfile","vue"],theme:{default:"dark-plus",dark:"github-dark"},highlighter:"shiki"},wsUrl:"",documentDriven:false,host:"",trailingSlash:false,search:"",contentHead:true,anchorLinks:{depth:4,exclude:[1]}},studio:{apiURL:"https://api.nuxt.studio",iframeMessagingAllowedOrigins:""}},app:{baseURL:"/",buildId:"b0922829-a51b-4fa4-a348-73c8ef816773",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script>
<script type="application/ld+json" id="schema-org-graph" data-hid="3437552">{"@context":"https://schema.org","@graph":[{"@id":"#website","@type":"WebSite","name":"nuxt-app"},{"@id":"/blog/scikit-learn-pipelines/#webpage","@type":"WebPage","description":"Going through a step by step guide for building machine learning pipelines for data preprocessing and inference, also covering how preprocess different columns with different transformers, how to add custom transformers, and how to save and load complete pipelines","name":"A Comprehensive Guide For scikit-learn Pipelines","url":"/blog/scikit-learn-pipelines","isPartOf":{"@id":"#website"},"potentialAction":[{"@type":"ReadAction","target":["/blog/scikit-learn-pipelines"]}]}]}</script></body></html>